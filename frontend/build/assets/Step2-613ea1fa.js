import{K as A,cw as M,e3 as V,e4 as W,j as e,e5 as G,a7 as d,e6 as E,b as K,u as U,r as O,d as R,Y as B,A as Z,z as _,L as F,a1 as Y,a2 as q}from"./index-d4dc8e82.js";import{C as H}from"./index.es-b5ad55ec.js";import{s as T,v as J,a as Q,u as X}from"./index-d5a514e4.js";import{u as ee}from"./useTimeOutMessage-b75b21c9.js";const k=A.forwardRef((b,c)=>{var j,v;const{asElement:f,size:i,inputSize:g,validationPattern:m=/[0-9]{1}/,value:p,onChange:t,className:S,...a}=b,{themeColor:l,controlSize:$,primaryColorLevel:u,direction:D}=M(),w=(j=V())==null?void 0:j.size,P=(v=W())==null?void 0:v.size,h=g||P||w||$,C=new Array(i).fill("-"),x=(r,o)=>{const s=r.target,N=r.target.value;if(!m.test(N)&&N!=="")return;const I=p.split("");I[o]=N;const L=I.join("").slice(0,6);if(t(L),N){const z=s.nextElementSibling||null;z==null||z.focus()}},y=r=>{const o=r.currentTarget;if(r.key==="ArrowLeft"||r.key==="Backspace"){const s=o.previousElementSibling||null;s==null||s.focus(),s==null||s.setSelectionRange(0,1);return}if(r.key==="ArrowRight"){const s=o.nextSibling||null;s==null||s.focus(),s==null||s.setSelectionRange(0,1);return}},n=r=>{r.preventDefault();const o=r.clipboardData.getData("text").substring(0,i);t(o)};return e.jsx("div",{className:"flex gap-2",children:C.map((r,o)=>e.jsx("input",{...a,className:S||`input focus:ring-${l}-${u} focus-within:ring-${l}-${u} focus-within:border-${l}-${u} focus:border-${l}-${u} px-0 text-center input-${h} h-${G[h]}`,type:"text",inputMode:"numeric",autoComplete:"one-time-code",pattern:m.source,onInvalid:s=>s.target.setCustomValidity("Please enter a number."),maxLength:i,value:p.at(o)??"",onChange:s=>x(s,o),onKeyUp:y,onPaste:n},o))})});k.propTypes={asElement:d.string,type:d.string,className:d.string,size:d.oneOf([4,6,8]),inputSize:d.oneOf([E.LG,E.SM,E.MD]),value:d.any};k.defaultProps={type:"text",asElement:"input",className:""};const re=({onBack:b})=>{var x,y;const c=K(),f=U(),[i,g]=O.useState(""),[m,p]=ee(),{profile:t}=R(n=>n.auth.user),{resent:S}=R(n=>n.verify.state),{status:a,verifyMessage:l,verifying:$,resending:u,timer:D}=R(n=>n.verify.data);O.useEffect(()=>{const n=()=>{Y.push(e.jsx(q,{title:`${a==="success"?"Success":"Error"}`,type:`${a==="success"?"success":"danger"}`,duration:2e3,children:a==="success"?"Phone number verified successfully!":"Looks like something went wrong, please try again."}),{placement:"top-center"})};(a==="success"||a==="error")&&(p(l),g(""),n(),c(B()))},[c,f,p,a,l]),O.useEffect(()=>{a==="success"&&f("/home")},[f,a]);const w=()=>{c(T(!0)),c(Q(!0)),c(X({phone:t==null?void 0:t.phone}))},P=()=>{c(T(!1)),c(J({phone:t==null?void 0:t.phone,otp:i}))},h=()=>{c(T(!0)),b()},C=({minutes:n,seconds:j,completed:v})=>v?e.jsx("span",{onClick:()=>w(),className:"font-bold text-gray-700 underline cursor-pointer",children:"Resend OTP"}):e.jsxs("span",{className:"font-bold text-gray-700",children:["Wait ",n,":",j," mins"]});return e.jsx("div",{className:"h-full flex flex-col justify-center p-6",children:e.jsxs("div",{className:"w-full flex flex-col gap-4 justify-center",children:[e.jsx("div",{className:"w-full flex justify-center items-center",children:e.jsx("img",{className:"w-72",src:"/img/signup.png",alt:""})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-center mt-4 text-2xl font-bold",children:"Verify Phone Number"}),S?e.jsxs("p",{className:"font-semibold text-center text-gray-400",children:["We have sent a new OTP to ",(x=t==null?void 0:t.phone)==null?void 0:x.replace(/(\d{3})(\d{4})(\d{3})(\d{4})/,"$1 $2 $3 $4")]}):e.jsxs("p",{className:"font-semibold text-center text-gray-400",children:["Enter the OTP code sent to ",(y=t==null?void 0:t.phone)==null?void 0:y.replace(/(\d{3})(\d{4})(\d{3})(\d{4})/,"$1 $2 $3 $4")]})]}),e.jsxs("div",{className:"mt-4",children:[m&&e.jsx(Z,{className:"mb-4",type:a==="error"?"danger":"success",showIcon:!0,children:m}),e.jsx("form",{onSubmit:async n=>{n.preventDefault(),P()},children:e.jsxs("div",{className:"grid place-content-center bg-base-100 max-w-sm mx-auto",children:[e.jsx(k,{inputSize:"lg",size:4,value:i,onChange:n=>{g(n)}}),e.jsx(_,{className:"mt-8",block:!0,variant:"solid",type:"submit",disabled:(i==null?void 0:i.length)<4,loading:$,children:"Verify & Proceed"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-gray-400 text-center font-semibold flex w-full justify-center gap-2",children:["Didn't receive the OTP? "," ",u?e.jsx("span",{className:"inline",children:e.jsx(F,{size:22,loading:!0})}):e.jsx(H,{date:D?Date.now()+9e4:Date.now(),renderer:C})]}),e.jsx("p",{onClick:()=>h(),className:"font-bold text-gray-700 text-center underline cursor-pointer mt-2",children:"Wrong phone number?"})]})]})})]})]})})};export{re as default};
