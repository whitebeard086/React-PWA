import{c as u,ae as O,f as U,a as F,r as c,n as x,P as w,j as a,F as R,p as k,a6 as E,w as I,a7 as P,V as $,W as z,o as B,J as N,af as j,L as A,H as D,g as H,y as V,x as G,ag as T,ah as v}from"./index-508e130b.js";import{C as _}from"./CropImage-80850938.js";import{F as J,a as M,b as W}from"./formik.esm-5d2ef744.js";import{a as q,b as K}from"./BrowseService-a7ed36dd.js";import{b as Q,c as X}from"./HomeService-cc82d975.js";import{u as Y}from"./useAuth-1f924dc5.js";import"./index.esm-985d0e24.js";const m=u("browse/data/getBrowseData",async(t,{rejectWithValue:e})=>{try{return(await q(t)).data}catch(s){return e(s.response.data)}}),y=u("settings/data/createCategory",async(t,{rejectWithValue:e})=>{try{return(await Q(t)).data}catch(s){return e(s.response.data)}}),b=u("settings/data/updateCategory",async(t,{rejectWithValue:e})=>{try{return(await X(t)).data}catch(s){return e(s.response.data)}}),C=u("browse/data/getCategory",async(t,{rejectWithValue:e})=>{try{return(await K(t)).data}catch(s){return e(s.response.data)}}),f=u("settings/data/uploadImage",async(t,{rejectWithValue:e})=>{try{return(await O(t)).data}catch(s){return e(s.response.data)}}),L=U({name:"settings/data",initialState:{gettingCategories:!1,gettingCategory:!1,creatingCategory:!1,updatingCategory:!1,uploading:!1,category:{},uploadStatus:"idle"},reducers:{setUploadStatus:(t,e)=>{t.uploadStatus=e.payload}},extraReducers:t=>{t.addCase(y.pending,e=>{e.creatingCategory=!0}).addCase(y.fulfilled,e=>{e.creatingCategory=!1}).addCase(y.rejected,e=>{e.creatingCategory=!1}).addCase(b.pending,e=>{e.updatingCategory=!0}).addCase(b.fulfilled,e=>{e.updatingCategory=!1}).addCase(b.rejected,e=>{e.updatingCategory=!1}).addCase(m.pending,e=>{e.gettingCategories=!0}).addCase(m.fulfilled,(e,s)=>{e.gettingCategories=!1,e.categories=s.payload.categories}).addCase(m.rejected,e=>{e.gettingCategories=!1}).addCase(C.pending,e=>{e.gettingCategory=!0}).addCase(C.fulfilled,(e,s)=>{e.gettingCategory=!1,e.category=s.payload.category}).addCase(C.rejected,e=>{e.gettingCategory=!1}).addCase(f.pending,e=>{e.uploading=!0}).addCase(f.fulfilled,(e,s)=>{e.uploading=!1,e.uploadStatus=s.payload.status}).addCase(f.rejected,e=>{e.uploading=!1,e.uploadStatus="error"})}}),{setUploadStatus:Z}=L.actions,ee=L.reducer,ae=()=>{const t=F(),[e,s]=c.useState(!1),[d,r]=c.useState(null),[i,h]=c.useState(null);console.log(i);const{uploadStatus:n}=x(o=>o.settings.data),g=c.useCallback(()=>{t(f({image:i})),t(w())},[t,i]),S=(o,p,l)=>{o.setFieldValue(p.name,URL.createObjectURL(l[0])),r(URL.createObjectURL(l[0])),s(!0)};return c.useEffect(()=>{i!==null&&g()},[i,g]),c.useEffect(()=>{n!=="idle"&&(()=>{$.push(a.jsx(z,{title:`${n==="success"?"Success":"Error"}`,type:`${n==="success"?"success":"danger"}`,duration:5e3,children:n==="success"?"Image uploaded successfully!":"Looks like something went wrong, please try again."}),{placement:"top-center"})})(),n==="success"&&t(w()),(n==="success"||n==="error")&&t(Z("idle"))},[t,n]),a.jsx(J,{initialValues:{image:""},onSubmit:g,children:()=>a.jsxs(M,{className:"absolute top-[45%] right-[23%]",children:[a.jsx(R,{children:a.jsx(k,{children:a.jsx(W,{name:"banner",children:({field:o,form:p})=>a.jsx(E,{showList:!1,uploadLimit:1,onChange:l=>S(p,o,l),onFileRemove:l=>S(p,o,l),children:a.jsx(I,{type:"button",size:"xs",className:"",variant:"solid",icon:a.jsx(P,{}),children:"Upload"})})})})}),a.jsx(_,{photoURL:d,setOpenCrop:s,openCrop:e,aspect:1/1,setPhotoURL:r,setFile:h,onCropImage:g,maxSizeMB:.05})]})})},se=()=>{const{imagePath:t}=D,{profile:e,gettingUser:s}=x(r=>r.auth.user),{uploading:d}=x(r=>r.settings.data);return a.jsxs("div",{className:"flex flex-col justify-center items-center mb-8",children:[a.jsx("div",{className:B("flex items-center flex-row gap-2 cursor-pointer relative"),children:s||d?a.jsxs("div",{className:"relative",children:[a.jsx(N,{size:150,icon:a.jsx(j,{}),src:e!=null&&e.image?`${t}/${e.image}`:null}),a.jsx("div",{className:"absolute top-0 w-full h-full grid place-content-center bg-black/50 rounded-lg",children:a.jsx(A,{loading:!0})})]}):a.jsxs("div",{className:"relative",children:[a.jsx(N,{size:150,className:"relative",icon:e!=null&&e.image?null:a.jsx(j,{}),src:e!=null&&e.image?`${t}/${e.image}`:null}),a.jsx(ae,{})]})}),a.jsxs("div",{className:"flex flex-col justify-center items-center",children:[a.jsx("h4",{className:"text-lg font-bold text-primary-500",children:e.username}),a.jsx("p",{className:"text-base font-semibold text-primary-500",children:e.email})]})]})},te=U({name:"settings/state",initialState:{},reducers:{}}),ne=te.reducer,re=H({state:ne,data:ee});V("settings",re);const pe=()=>{const{handleSignOut:t}=Y(),e=F();window.OneSignal=window.OneSignal||[];const s=window.OneSignal;c.useEffect(()=>{e(m())},[]);const{userType:d,enabledNotifications:r,profile:i}=x(n=>n.auth.user);s.push(()=>{s.init({appId:"9749386f-0c3b-417c-b986-3447a73296cd",safari_web_id:"web.onesignal.auto.4d0b3421-6847-4c4b-a531-b4bcf634e4d8",allowLocalhostAsSecureOrigin:!0,autoResubscribe:!0,promptOptions:{customlink:{enabled:!0,style:"button",size:"small",color:{button:"",text:"#FFFFFF"},text:{subscribe:"Subscribe to push notifications",unsubscribe:"Unsubscribe from push notifications"},unsubscribeEnabled:!0}}})});const h=()=>{s.push(function(){s.isPushNotificationsEnabled(function(n){n?(console.log("Push notifications are enabled!"),s.setExternalUserId(i==null?void 0:i.id),r||e(v(!0))):(console.log("Push notifications are not enabled yet."),r&&e(v(!1)))})})};return a.jsxs("div",{className:"bg-white min-h-[80vh]",children:[a.jsx(se,{}),a.jsx("hr",{}),a.jsx("div",{className:"",children:a.jsxs("div",{children:[d==="Provider"&&a.jsx(a.Fragment,{children:a.jsxs(G,{className:"flex gap-2 items-center transition duration-300 w-full py-4 px-4 hover:bg-gray-100",to:"/profile",children:[a.jsx("span",{className:"text-xl opacity-50",children:a.jsx(j,{})}),a.jsx("span",{className:"text-base font-semibold text-gray-600",children:"Profile"})]})}),a.jsx("hr",{className:""}),a.jsx("div",{onClick:h,className:"onesignal-customlink-container"}),a.jsxs("div",{onClick:t,className:"flex items-center gap-2 cursor-pointer transition duration-300 w-full py-4 px-4 hover:bg-gray-100",children:[a.jsx("span",{className:"text-xl text-red-500 opacity-50",children:a.jsx(T,{})}),a.jsx("span",{className:"w-full text-base font-semibold text-red-500",children:"Logout"})]})]})})]})};export{pe as default};
