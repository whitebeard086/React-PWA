import{a9 as Ce,K as b,b7 as be,r as R,j as y,E as Me,z as oe,b8 as Se,b9 as Re,ba as Ee}from"./index-d4dc8e82.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var V=function(n,s){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])},V(n,s)};function De(n,s){V(n,s);function e(){this.constructor=n}n.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)}var x=function(){return x=Object.assign||function(s){for(var e,o=1,t=arguments.length;o<t;o++){e=arguments[o];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},x.apply(this,arguments)},ne=!1,D,H,X,L,F,le,I,G,Y,q,de,$,J,fe,me;function C(){if(!ne){ne=!0;var n=navigator.userAgent,s=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(n),e=/(Mac OS X)|(Windows)|(Linux)/.exec(n);if($=/\b(iPhone|iP[ao]d)/.exec(n),J=/\b(iP[ao]d)/.exec(n),q=/Android/i.exec(n),fe=/FBAN\/\w+;/i.exec(n),me=/Mobile/i.exec(n),de=!!/Win64/.exec(n),s){D=s[1]?parseFloat(s[1]):s[5]?parseFloat(s[5]):NaN,D&&document&&document.documentMode&&(D=document.documentMode);var o=/(?:Trident\/(\d+.\d+))/.exec(n);le=o?parseFloat(o[1])+4:D,H=s[2]?parseFloat(s[2]):NaN,X=s[3]?parseFloat(s[3]):NaN,L=s[4]?parseFloat(s[4]):NaN,L?(s=/(?:Chrome\/(\d+\.\d+))/.exec(n),F=s&&s[1]?parseFloat(s[1]):NaN):F=NaN}else D=H=X=F=L=NaN;if(e){if(e[1]){var t=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(n);I=t?parseFloat(t[1].replace("_",".")):!0}else I=!1;G=!!e[2],Y=!!e[3]}else I=G=Y=!1}}var Q={ie:function(){return C()||D},ieCompatibilityMode:function(){return C()||le>D},ie64:function(){return Q.ie()&&de},firefox:function(){return C()||H},opera:function(){return C()||X},webkit:function(){return C()||L},safari:function(){return Q.webkit()},chrome:function(){return C()||F},windows:function(){return C()||G},osx:function(){return C()||I},linux:function(){return C()||Y},iphone:function(){return C()||$},mobile:function(){return C()||$||J||q||me},nativeApp:function(){return C()||fe},android:function(){return C()||q},ipad:function(){return C()||J}},_e=Q,A=!!(typeof window<"u"&&window.document&&window.document.createElement),Pe={canUseDOM:A,canUseWorkers:typeof Worker<"u",canUseEventListeners:A&&!!(window.addEventListener||window.attachEvent),canUseViewport:A&&!!window.screen,isInWorker:!A},ze=Pe,ve=ze,ge;ve.canUseDOM&&(ge=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function Te(n,s){if(!ve.canUseDOM||s&&!("addEventListener"in document))return!1;var e="on"+n,o=e in document;if(!o){var t=document.createElement("div");t.setAttribute(e,"return;"),o=typeof t[e]=="function"}return!o&&ge&&n==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}var Ae=Te,Ne=_e,Oe=Ae,re=10,ie=40,se=800;function we(n){var s=0,e=0,o=0,t=0;return"detail"in n&&(e=n.detail),"wheelDelta"in n&&(e=-n.wheelDelta/120),"wheelDeltaY"in n&&(e=-n.wheelDeltaY/120),"wheelDeltaX"in n&&(s=-n.wheelDeltaX/120),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(s=e,e=0),o=s*re,t=e*re,"deltaY"in n&&(t=n.deltaY),"deltaX"in n&&(o=n.deltaX),(o||t)&&n.deltaMode&&(n.deltaMode==1?(o*=ie,t*=ie):(o*=se,t*=se)),o&&!s&&(s=o<1?-1:1),t&&!e&&(e=t<1?-1:1),{spinX:s,spinY:e,pixelX:o,pixelY:t}}we.getEventType=function(){return Ne.firefox()?"DOMMouseScroll":Oe("wheel")?"wheel":"mousewheel"};var ke=we,We=ke;const Le=Ce(We);function Fe(n,s,e,o,t,r){r===void 0&&(r=0);var a=P(n,s,r),i=a.width,c=a.height,h=Math.min(i,e),u=Math.min(c,o);return h>u*t?{width:u*t,height:u}:{width:h,height:h/t}}function Ie(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function N(n,s,e,o,t){t===void 0&&(t=0);var r=P(s.width,s.height,t),a=r.width,i=r.height;return{x:ae(n.x,a,e.width,o),y:ae(n.y,i,e.height,o)}}function ae(n,s,e,o){var t=s*o/2-e/2;return j(n,-t,t)}function ce(n,s){return Math.sqrt(Math.pow(n.y-s.y,2)+Math.pow(n.x-s.x,2))}function he(n,s){return Math.atan2(s.y-n.y,s.x-n.x)*180/Math.PI}function je(n,s,e,o,t,r,a){r===void 0&&(r=0),a===void 0&&(a=!0);var i=a?Be:Ke,c=P(s.width,s.height,r),h=P(s.naturalWidth,s.naturalHeight,r),u={x:i(100,((c.width-e.width/t)/2-n.x/t)/c.width*100),y:i(100,((c.height-e.height/t)/2-n.y/t)/c.height*100),width:i(100,e.width/c.width*100/t),height:i(100,e.height/c.height*100/t)},p=Math.round(i(h.width,u.width*h.width/100)),l=Math.round(i(h.height,u.height*h.height/100)),d=h.width>=h.height*o,m=d?{width:Math.round(l*o),height:l}:{width:p,height:Math.round(p/o)},g=x(x({},m),{x:Math.round(i(h.width-m.width,u.x*h.width/100)),y:Math.round(i(h.height-m.height,u.y*h.height/100))});return{croppedAreaPercentages:u,croppedAreaPixels:g}}function Be(n,s){return Math.min(n,Math.max(0,s))}function Ke(n,s){return s}function Ze(n,s,e,o,t,r){var a=P(s.width,s.height,e),i=j(o.width/a.width*(100/n.width),t,r),c={x:i*a.width/2-o.width/2-a.width*i*(n.x/100),y:i*a.height/2-o.height/2-a.height*i*(n.y/100)};return{crop:c,zoom:i}}function Ue(n,s,e){var o=Ie(s);return e.height>e.width?e.height/(n.height*o):e.width/(n.width*o)}function Ve(n,s,e,o,t,r){e===void 0&&(e=0);var a=P(s.naturalWidth,s.naturalHeight,e),i=j(Ue(n,s,o),t,r),c=o.height>o.width?o.height/n.height:o.width/n.width,h={x:((a.width-n.width)/2-n.x)*c,y:((a.height-n.height)/2-n.y)*c};return{crop:h,zoom:i}}function ue(n,s){return{x:(s.x+n.x)/2,y:(s.y+n.y)/2}}function He(n){return n*Math.PI/180}function P(n,s,e){var o=He(e);return{width:Math.abs(Math.cos(o)*n)+Math.abs(Math.sin(o)*s),height:Math.abs(Math.sin(o)*n)+Math.abs(Math.cos(o)*s)}}function j(n,s,e){return Math.min(Math.max(n,s),e)}function O(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return n.filter(function(e){return typeof e=="string"&&e.length>0}).join(" ").trim()}var Xe=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,Ge=1,Ye=3,qe=function(n){De(s,n);function s(){var e=n!==null&&n.apply(this,arguments)||this;return e.imageRef=b.createRef(),e.videoRef=b.createRef(),e.containerRef=null,e.styleRef=null,e.containerRect=null,e.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},e.dragStartPosition={x:0,y:0},e.dragStartCrop={x:0,y:0},e.gestureZoomStart=0,e.gestureRotationStart=0,e.isTouching=!1,e.lastPinchDistance=0,e.lastPinchRotation=0,e.rafDragTimeout=null,e.rafPinchTimeout=null,e.wheelTimer=null,e.currentDoc=typeof document<"u"?document:null,e.currentWindow=typeof window<"u"?window:null,e.resizeObserver=null,e.state={cropSize:null,hasWheelJustStarted:!1},e.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!e.containerRef)){var o=!0;e.resizeObserver=new window.ResizeObserver(function(t){if(o){o=!1;return}e.computeSizes()}),e.resizeObserver.observe(e.containerRef)}},e.preventZoomSafari=function(o){return o.preventDefault()},e.cleanEvents=function(){e.currentDoc&&(e.currentDoc.removeEventListener("mousemove",e.onMouseMove),e.currentDoc.removeEventListener("mouseup",e.onDragStopped),e.currentDoc.removeEventListener("touchmove",e.onTouchMove),e.currentDoc.removeEventListener("touchend",e.onDragStopped),e.currentDoc.removeEventListener("gesturemove",e.onGestureMove),e.currentDoc.removeEventListener("gestureend",e.onGestureEnd))},e.clearScrollEvent=function(){e.containerRef&&e.containerRef.removeEventListener("wheel",e.onWheel),e.wheelTimer&&clearTimeout(e.wheelTimer)},e.onMediaLoad=function(){var o=e.computeSizes();o&&(e.emitCropData(),e.setInitialCrop(o)),e.props.onMediaLoaded&&e.props.onMediaLoaded(e.mediaSize)},e.setInitialCrop=function(o){if(e.props.initialCroppedAreaPercentages){var t=Ze(e.props.initialCroppedAreaPercentages,e.mediaSize,e.props.rotation,o,e.props.minZoom,e.props.maxZoom),r=t.crop,a=t.zoom;e.props.onCropChange(r),e.props.onZoomChange&&e.props.onZoomChange(a)}else if(e.props.initialCroppedAreaPixels){var i=Ve(e.props.initialCroppedAreaPixels,e.mediaSize,e.props.rotation,o,e.props.minZoom,e.props.maxZoom),r=i.crop,a=i.zoom;e.props.onCropChange(r),e.props.onZoomChange&&e.props.onZoomChange(a)}},e.computeSizes=function(){var o,t,r,a,i,c,h=e.imageRef.current||e.videoRef.current;if(h&&e.containerRef){e.containerRect=e.containerRef.getBoundingClientRect();var u=e.containerRect.width/e.containerRect.height,p=((o=e.imageRef.current)===null||o===void 0?void 0:o.naturalWidth)||((t=e.videoRef.current)===null||t===void 0?void 0:t.videoWidth)||0,l=((r=e.imageRef.current)===null||r===void 0?void 0:r.naturalHeight)||((a=e.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,d=h.offsetWidth<p||h.offsetHeight<l,m=p/l,g=void 0;if(d){var v=e.getObjectFit();switch(v){default:case"contain":g=u>m?{width:e.containerRect.height*m,height:e.containerRect.height}:{width:e.containerRect.width,height:e.containerRect.width/m};break;case"horizontal-cover":g={width:e.containerRect.width,height:e.containerRect.width/m};break;case"vertical-cover":g={width:e.containerRect.height*m,height:e.containerRect.height};break}}else g={width:h.offsetWidth,height:h.offsetHeight};e.mediaSize=x(x({},g),{naturalWidth:p,naturalHeight:l}),e.props.setMediaSize&&e.props.setMediaSize(e.mediaSize);var w=e.props.cropSize?e.props.cropSize:Fe(e.mediaSize.width,e.mediaSize.height,e.containerRect.width,e.containerRect.height,e.props.aspect,e.props.rotation);return(((i=e.state.cropSize)===null||i===void 0?void 0:i.height)!==w.height||((c=e.state.cropSize)===null||c===void 0?void 0:c.width)!==w.width)&&e.props.onCropSizeChange&&e.props.onCropSizeChange(w),e.setState({cropSize:w},e.recomputeCropPosition),e.props.setCropSize&&e.props.setCropSize(w),w}},e.onMouseDown=function(o){e.currentDoc&&(o.preventDefault(),e.currentDoc.addEventListener("mousemove",e.onMouseMove),e.currentDoc.addEventListener("mouseup",e.onDragStopped),e.onDragStart(s.getMousePoint(o)))},e.onMouseMove=function(o){return e.onDrag(s.getMousePoint(o))},e.onTouchStart=function(o){e.currentDoc&&(e.isTouching=!0,!(e.props.onTouchRequest&&!e.props.onTouchRequest(o))&&(e.currentDoc.addEventListener("touchmove",e.onTouchMove,{passive:!1}),e.currentDoc.addEventListener("touchend",e.onDragStopped),o.touches.length===2?e.onPinchStart(o):o.touches.length===1&&e.onDragStart(s.getTouchPoint(o.touches[0]))))},e.onTouchMove=function(o){o.preventDefault(),o.touches.length===2?e.onPinchMove(o):o.touches.length===1&&e.onDrag(s.getTouchPoint(o.touches[0]))},e.onGestureStart=function(o){e.currentDoc&&(o.preventDefault(),e.currentDoc.addEventListener("gesturechange",e.onGestureMove),e.currentDoc.addEventListener("gestureend",e.onGestureEnd),e.gestureZoomStart=e.props.zoom,e.gestureRotationStart=e.props.rotation)},e.onGestureMove=function(o){if(o.preventDefault(),!e.isTouching){var t=s.getMousePoint(o),r=e.gestureZoomStart-1+o.scale;if(e.setNewZoom(r,t,{shouldUpdatePosition:!0}),e.props.onRotationChange){var a=e.gestureRotationStart+o.rotation;e.props.onRotationChange(a)}}},e.onGestureEnd=function(o){e.cleanEvents()},e.onDragStart=function(o){var t,r,a=o.x,i=o.y;e.dragStartPosition={x:a,y:i},e.dragStartCrop=x({},e.props.crop),(r=(t=e.props).onInteractionStart)===null||r===void 0||r.call(t)},e.onDrag=function(o){var t=o.x,r=o.y;e.currentWindow&&(e.rafDragTimeout&&e.currentWindow.cancelAnimationFrame(e.rafDragTimeout),e.rafDragTimeout=e.currentWindow.requestAnimationFrame(function(){if(e.state.cropSize&&!(t===void 0||r===void 0)){var a=t-e.dragStartPosition.x,i=r-e.dragStartPosition.y,c={x:e.dragStartCrop.x+a,y:e.dragStartCrop.y+i},h=e.props.restrictPosition?N(c,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):c;e.props.onCropChange(h)}}))},e.onDragStopped=function(){var o,t;e.isTouching=!1,e.cleanEvents(),e.emitCropData(),(t=(o=e.props).onInteractionEnd)===null||t===void 0||t.call(o)},e.onWheel=function(o){if(e.currentWindow&&!(e.props.onWheelRequest&&!e.props.onWheelRequest(o))){o.preventDefault();var t=s.getMousePoint(o),r=Le(o).pixelY,a=e.props.zoom-r*e.props.zoomSpeed/200;e.setNewZoom(a,t,{shouldUpdatePosition:!0}),e.state.hasWheelJustStarted||e.setState({hasWheelJustStarted:!0},function(){var i,c;return(c=(i=e.props).onInteractionStart)===null||c===void 0?void 0:c.call(i)}),e.wheelTimer&&clearTimeout(e.wheelTimer),e.wheelTimer=e.currentWindow.setTimeout(function(){return e.setState({hasWheelJustStarted:!1},function(){var i,c;return(c=(i=e.props).onInteractionEnd)===null||c===void 0?void 0:c.call(i)})},250)}},e.getPointOnContainer=function(o){var t=o.x,r=o.y;if(!e.containerRect)throw new Error("The Cropper is not mounted");return{x:e.containerRect.width/2-(t-e.containerRect.left),y:e.containerRect.height/2-(r-e.containerRect.top)}},e.getPointOnMedia=function(o){var t=o.x,r=o.y,a=e.props,i=a.crop,c=a.zoom;return{x:(t+i.x)/c,y:(r+i.y)/c}},e.setNewZoom=function(o,t,r){var a=r===void 0?{}:r,i=a.shouldUpdatePosition,c=i===void 0?!0:i;if(!(!e.state.cropSize||!e.props.onZoomChange)){var h=j(o,e.props.minZoom,e.props.maxZoom);if(c){var u=e.getPointOnContainer(t),p=e.getPointOnMedia(u),l={x:p.x*h-u.x,y:p.y*h-u.y},d=e.props.restrictPosition?N(l,e.mediaSize,e.state.cropSize,h,e.props.rotation):l;e.props.onCropChange(d)}e.props.onZoomChange(h)}},e.getCropData=function(){if(!e.state.cropSize)return null;var o=e.props.restrictPosition?N(e.props.crop,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):e.props.crop;return je(o,e.mediaSize,e.state.cropSize,e.getAspect(),e.props.zoom,e.props.rotation,e.props.restrictPosition)},e.emitCropData=function(){var o=e.getCropData();if(o){var t=o.croppedAreaPercentages,r=o.croppedAreaPixels;e.props.onCropComplete&&e.props.onCropComplete(t,r),e.props.onCropAreaChange&&e.props.onCropAreaChange(t,r)}},e.emitCropAreaChange=function(){var o=e.getCropData();if(o){var t=o.croppedAreaPercentages,r=o.croppedAreaPixels;e.props.onCropAreaChange&&e.props.onCropAreaChange(t,r)}},e.recomputeCropPosition=function(){if(e.state.cropSize){var o=e.props.restrictPosition?N(e.props.crop,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):e.props.crop;e.props.onCropChange(o),e.emitCropData()}},e}return s.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=Xe,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef))},s.prototype.componentWillUnmount=function(){var e,o;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((o=this.styleRef.parentNode)===null||o===void 0||o.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},s.prototype.componentDidUpdate=function(e){var o,t,r,a,i,c,h,u,p;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():((o=e.cropSize)===null||o===void 0?void 0:o.height)!==((t=this.props.cropSize)===null||t===void 0?void 0:t.height)||((r=e.cropSize)===null||r===void 0?void 0:r.width)!==((a=this.props.cropSize)===null||a===void 0?void 0:a.width)?this.computeSizes():(((i=e.crop)===null||i===void 0?void 0:i.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((h=e.crop)===null||h===void 0?void 0:h.y)!==((u=this.props.crop)===null||u===void 0?void 0:u.y))&&this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load())},s.prototype.getAspect=function(){var e=this.props,o=e.cropSize,t=e.aspect;return o?o.width/o.height:t},s.prototype.getObjectFit=function(){var e,o,t,r;if(this.props.objectFit==="cover"){var a=this.imageRef.current||this.videoRef.current;if(a&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var i=this.containerRect.width/this.containerRect.height,c=((e=this.imageRef.current)===null||e===void 0?void 0:e.naturalWidth)||((o=this.videoRef.current)===null||o===void 0?void 0:o.videoWidth)||0,h=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalHeight)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoHeight)||0,u=c/h;return u<i?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},s.prototype.onPinchStart=function(e){var o=s.getTouchPoint(e.touches[0]),t=s.getTouchPoint(e.touches[1]);this.lastPinchDistance=ce(o,t),this.lastPinchRotation=he(o,t),this.onDragStart(ue(o,t))},s.prototype.onPinchMove=function(e){var o=this;if(!(!this.currentDoc||!this.currentWindow)){var t=s.getTouchPoint(e.touches[0]),r=s.getTouchPoint(e.touches[1]),a=ue(t,r);this.onDrag(a),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var i=ce(t,r),c=o.props.zoom*(i/o.lastPinchDistance);o.setNewZoom(c,a,{shouldUpdatePosition:!1}),o.lastPinchDistance=i;var h=he(t,r),u=o.props.rotation+(h-o.lastPinchRotation);o.props.onRotationChange&&o.props.onRotationChange(u),o.lastPinchRotation=h})}},s.prototype.render=function(){var e=this,o=this.props,t=o.image,r=o.video,a=o.mediaProps,i=o.transform,c=o.crop,h=c.x,u=c.y,p=o.rotation,l=o.zoom,d=o.cropShape,m=o.showGrid,g=o.style,v=g.containerStyle,w=g.cropAreaStyle,T=g.mediaStyle,z=o.classes,B=z.containerClassName,K=z.cropAreaClassName,_=z.mediaClassName,M=this.getObjectFit();return b.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(S){return e.containerRef=S},"data-testid":"container",style:v,className:O("reactEasyCrop_Container",B)},t?b.createElement("img",x({alt:"",className:O("reactEasyCrop_Image",M==="contain"&&"reactEasyCrop_Contain",M==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",M==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",_)},a,{src:t,ref:this.imageRef,style:x(x({},T),{transform:i||"translate(".concat(h,"px, ").concat(u,"px) rotate(").concat(p,"deg) scale(").concat(l,")")}),onLoad:this.onMediaLoad})):r&&b.createElement("video",x({autoPlay:!0,loop:!0,muted:!0,className:O("reactEasyCrop_Video",M==="contain"&&"reactEasyCrop_Contain",M==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",M==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",_)},a,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:x(x({},T),{transform:i||"translate(".concat(h,"px, ").concat(u,"px) rotate(").concat(p,"deg) scale(").concat(l,")")}),controls:!1}),(Array.isArray(r)?r:[{src:r}]).map(function(f){return b.createElement("source",x({key:f.src},f))})),this.state.cropSize&&b.createElement("div",{style:x(x({},w),{width:this.state.cropSize.width,height:this.state.cropSize.height}),"data-testid":"cropper",className:O("reactEasyCrop_CropArea",d==="round"&&"reactEasyCrop_CropAreaRound",m&&"reactEasyCrop_CropAreaGrid",K)}))},s.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:Ye,minZoom:Ge,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0},s.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},s.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},s}(b.Component);function $e(n,s){n.prototype=Object.create(s.prototype),n.prototype.constructor=n,be(n,s)}function Z(n){return n&&n.stopPropagation&&n.stopPropagation(),n&&n.preventDefault&&n.preventDefault(),!1}function U(n){return n==null?[]:Array.isArray(n)?n.slice():[n]}function k(n){return n!==null&&n.length===1?n[0]:n.slice()}function W(n){Object.keys(n).forEach(s=>{typeof document<"u"&&document.addEventListener(s,n[s],!1)})}function E(n,s){return ee(function(e,o){let t=e;return t<=o.min&&(t=o.min),t>=o.max&&(t=o.max),t}(n,s),s)}function ee(n,s){const e=(n-s.min)%s.step;let o=n-e;return 2*Math.abs(e)>=s.step&&(o+=e>0?s.step:-s.step),parseFloat(o.toFixed(5))}let te=function(n){function s(o){var t;(t=n.call(this,o)||this).onKeyUp=()=>{t.onEnd()},t.onMouseUp=()=>{t.onEnd(t.getMouseEventMap())},t.onTouchEnd=i=>{i.preventDefault(),t.onEnd(t.getTouchEventMap())},t.onBlur=()=>{t.setState({index:-1},t.onEnd(t.getKeyDownEventMap()))},t.onMouseMove=i=>{t.setState({pending:!0});const c=t.getMousePosition(i),h=t.getDiffPosition(c[0]),u=t.getValueFromPosition(h);t.move(u)},t.onTouchMove=i=>{if(i.touches.length>1)return;t.setState({pending:!0});const c=t.getTouchPosition(i);if(t.isScrolling===void 0){const p=c[0]-t.startPosition[0],l=c[1]-t.startPosition[1];t.isScrolling=Math.abs(l)>Math.abs(p)}if(t.isScrolling)return void t.setState({index:-1});const h=t.getDiffPosition(c[0]),u=t.getValueFromPosition(h);t.move(u)},t.onKeyDown=i=>{if(!(i.ctrlKey||i.shiftKey||i.altKey||i.metaKey))switch(t.setState({pending:!0}),i.key){case"ArrowLeft":case"ArrowDown":case"Left":case"Down":i.preventDefault(),t.moveDownByStep();break;case"ArrowRight":case"ArrowUp":case"Right":case"Up":i.preventDefault(),t.moveUpByStep();break;case"Home":i.preventDefault(),t.move(t.props.min);break;case"End":i.preventDefault(),t.move(t.props.max);break;case"PageDown":i.preventDefault(),t.moveDownByStep(t.props.pageFn(t.props.step));break;case"PageUp":i.preventDefault(),t.moveUpByStep(t.props.pageFn(t.props.step))}},t.onSliderMouseDown=i=>{if(!t.props.disabled&&i.button!==2){if(t.setState({pending:!0}),!t.props.snapDragDisabled){const c=t.getMousePosition(i);t.forceValueFromPosition(c[0],h=>{t.start(h,c[0]),W(t.getMouseEventMap())})}Z(i)}},t.onSliderClick=i=>{if(!t.props.disabled&&t.props.onSliderClick&&!t.hasMoved){const c=t.getMousePosition(i),h=E(t.calcValue(t.calcOffsetFromPosition(c[0])),t.props);t.props.onSliderClick(h)}},t.createOnKeyDown=i=>c=>{t.props.disabled||(t.start(i),W(t.getKeyDownEventMap()),Z(c))},t.createOnMouseDown=i=>c=>{if(t.props.disabled||c.button===2)return;t.setState({pending:!0});const h=t.getMousePosition(c);t.start(i,h[0]),W(t.getMouseEventMap()),Z(c)},t.createOnTouchStart=i=>c=>{if(t.props.disabled||c.touches.length>1)return;t.setState({pending:!0});const h=t.getTouchPosition(c);t.startPosition=h,t.isScrolling=void 0,t.start(i,h[0]),W(t.getTouchEventMap()),function(u){u.stopPropagation&&u.stopPropagation()}(c)},t.handleResize=()=>{const i=window.setTimeout(()=>{t.pendingResizeTimeouts.shift(),t.resize()},0);t.pendingResizeTimeouts.push(i)},t.renderThumb=(i,c)=>{const h=t.props.thumbClassName+" "+t.props.thumbClassName+"-"+c+" "+(t.state.index===c?t.props.thumbActiveClassName:""),u={ref:l=>{t["thumb"+c]=l},key:t.props.thumbClassName+"-"+c,className:h,style:i,onMouseDown:t.createOnMouseDown(c),onTouchStart:t.createOnTouchStart(c),onFocus:t.createOnKeyDown(c),tabIndex:0,role:"slider","aria-orientation":t.props.orientation,"aria-valuenow":t.state.value[c],"aria-valuemin":t.props.min,"aria-valuemax":t.props.max,"aria-label":Array.isArray(t.props.ariaLabel)?t.props.ariaLabel[c]:t.props.ariaLabel,"aria-labelledby":Array.isArray(t.props.ariaLabelledby)?t.props.ariaLabelledby[c]:t.props.ariaLabelledby,"aria-disabled":t.props.disabled},p={index:c,value:k(t.state.value),valueNow:t.state.value[c]};return t.props.ariaValuetext&&(u["aria-valuetext"]=typeof t.props.ariaValuetext=="string"?t.props.ariaValuetext:t.props.ariaValuetext(p)),t.props.renderThumb(u,p)},t.renderTrack=(i,c,h)=>{const u={key:t.props.trackClassName+"-"+i,className:t.props.trackClassName+" "+t.props.trackClassName+"-"+i,style:t.buildTrackStyle(c,t.state.upperBound-h)},p={index:i,value:k(t.state.value)};return t.props.renderTrack(u,p)};let r=U(o.value);r.length||(r=U(o.defaultValue)),t.pendingResizeTimeouts=[];const a=[];for(let i=0;i<r.length;i+=1)r[i]=E(r[i],o),a.push(i);return t.resizeObserver=null,t.resizeElementRef=b.createRef(),t.state={index:-1,upperBound:0,sliderLength:0,value:r,zIndices:a},t}$e(s,n);var e=s.prototype;return e.componentDidMount=function(){typeof window<"u"&&(this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.resizeElementRef.current),this.resize())},s.getDerivedStateFromProps=function(o,t){const r=U(o.value);return r.length?t.pending?null:{value:r.map(a=>E(a,o))}:null},e.componentDidUpdate=function(){this.state.upperBound===0&&this.resize()},e.componentWillUnmount=function(){this.clearPendingResizeTimeouts(),this.resizeObserver&&this.resizeObserver.disconnect()},e.onEnd=function(o){o&&function(t){Object.keys(t).forEach(r=>{typeof document<"u"&&document.removeEventListener(r,t[r],!1)})}(o),this.hasMoved&&this.fireChangeEvent("onAfterChange"),this.setState({pending:!1}),this.hasMoved=!1},e.getValue=function(){return k(this.state.value)},e.getClosestIndex=function(o){let t=Number.MAX_VALUE,r=-1;const{value:a}=this.state,i=a.length;for(let c=0;c<i;c+=1){const h=this.calcOffset(a[c]),u=Math.abs(o-h);u<t&&(t=u,r=c)}return r},e.getMousePosition=function(o){return[o["page"+this.axisKey()],o["page"+this.orthogonalAxisKey()]]},e.getTouchPosition=function(o){const t=o.touches[0];return[t["page"+this.axisKey()],t["page"+this.orthogonalAxisKey()]]},e.getKeyDownEventMap=function(){return{keydown:this.onKeyDown,keyup:this.onKeyUp,focusout:this.onBlur}},e.getMouseEventMap=function(){return{mousemove:this.onMouseMove,mouseup:this.onMouseUp}},e.getTouchEventMap=function(){return{touchmove:this.onTouchMove,touchend:this.onTouchEnd}},e.getValueFromPosition=function(o){const t=o/(this.state.sliderLength-this.state.thumbSize)*(this.props.max-this.props.min);return E(this.state.startValue+t,this.props)},e.getDiffPosition=function(o){let t=o-this.state.startPosition;return this.props.invert&&(t*=-1),t},e.resize=function(){const{slider:o,thumb0:t}=this;if(!o||!t)return;const r=this.sizeKey(),a=o.getBoundingClientRect(),i=o[r],c=a[this.posMaxKey()],h=a[this.posMinKey()],u=t.getBoundingClientRect()[r.replace("client","").toLowerCase()],p=i-u,l=Math.abs(c-h);this.state.upperBound===p&&this.state.sliderLength===l&&this.state.thumbSize===u||this.setState({upperBound:p,sliderLength:l,thumbSize:u})},e.calcOffset=function(o){const t=this.props.max-this.props.min;return t===0?0:(o-this.props.min)/t*this.state.upperBound},e.calcValue=function(o){return o/this.state.upperBound*(this.props.max-this.props.min)+this.props.min},e.calcOffsetFromPosition=function(o){const{slider:t}=this,r=t.getBoundingClientRect(),a=r[this.posMaxKey()],i=r[this.posMinKey()];let c=o-(window["page"+this.axisKey()+"Offset"]+(this.props.invert?a:i));return this.props.invert&&(c=this.state.sliderLength-c),c-=this.state.thumbSize/2,c},e.forceValueFromPosition=function(o,t){const r=this.calcOffsetFromPosition(o),a=this.getClosestIndex(r),i=E(this.calcValue(r),this.props),c=this.state.value.slice();c[a]=i;for(let h=0;h<c.length-1;h+=1)if(c[h+1]-c[h]<this.props.minDistance)return;this.fireChangeEvent("onBeforeChange"),this.hasMoved=!0,this.setState({value:c},()=>{t(a),this.fireChangeEvent("onChange")})},e.clearPendingResizeTimeouts=function(){do{const o=this.pendingResizeTimeouts.shift();clearTimeout(o)}while(this.pendingResizeTimeouts.length)},e.start=function(o,t){const r=this["thumb"+o];r&&r.focus();const{zIndices:a}=this.state;a.splice(a.indexOf(o),1),a.push(o),this.setState(i=>({startValue:i.value[o],startPosition:t!==void 0?t:i.startPosition,index:o,zIndices:a}))},e.moveUpByStep=function(o){o===void 0&&(o=this.props.step);const t=this.state.value[this.state.index],r=E(this.props.invert&&this.props.orientation==="horizontal"?t-o:t+o,this.props);this.move(Math.min(r,this.props.max))},e.moveDownByStep=function(o){o===void 0&&(o=this.props.step);const t=this.state.value[this.state.index],r=E(this.props.invert&&this.props.orientation==="horizontal"?t+o:t-o,this.props);this.move(Math.max(r,this.props.min))},e.move=function(o){const t=this.state.value.slice(),{index:r}=this.state,{length:a}=t,i=t[r];if(o===i)return;this.hasMoved||this.fireChangeEvent("onBeforeChange"),this.hasMoved=!0;const{pearling:c,max:h,min:u,minDistance:p}=this.props;if(!c){if(r>0){const l=t[r-1];o<l+p&&(o=l+p)}if(r<a-1){const l=t[r+1];o>l-p&&(o=l-p)}}t[r]=o,c&&a>1&&(o>i?(this.pushSucceeding(t,p,r),function(l,d,m,g){for(let v=0;v<l;v+=1){const w=g-v*m;d[l-1-v]>w&&(d[l-1-v]=w)}}(a,t,p,h)):o<i&&(this.pushPreceding(t,p,r),function(l,d,m,g){for(let v=0;v<l;v+=1){const w=g+v*m;d[v]<w&&(d[v]=w)}}(a,t,p,u))),this.setState({value:t},this.fireChangeEvent.bind(this,"onChange"))},e.pushSucceeding=function(o,t,r){let a,i;for(a=r,i=o[a]+t;o[a+1]!==null&&i>o[a+1];a+=1,i=o[a]+t)o[a+1]=ee(i,this.props)},e.pushPreceding=function(o,t,r){for(let a=r,i=o[a]-t;o[a-1]!==null&&i<o[a-1];a-=1,i=o[a]-t)o[a-1]=ee(i,this.props)},e.axisKey=function(){return this.props.orientation==="vertical"?"Y":"X"},e.orthogonalAxisKey=function(){return this.props.orientation==="vertical"?"X":"Y"},e.posMinKey=function(){return this.props.orientation==="vertical"?this.props.invert?"bottom":"top":this.props.invert?"right":"left"},e.posMaxKey=function(){return this.props.orientation==="vertical"?this.props.invert?"top":"bottom":this.props.invert?"left":"right"},e.sizeKey=function(){return this.props.orientation==="vertical"?"clientHeight":"clientWidth"},e.fireChangeEvent=function(o){this.props[o]&&this.props[o](k(this.state.value),this.state.index)},e.buildThumbStyle=function(o,t){const r={position:"absolute",touchAction:"none",willChange:this.state.index>=0?this.posMinKey():void 0,zIndex:this.state.zIndices.indexOf(t)+1};return r[this.posMinKey()]=o+"px",r},e.buildTrackStyle=function(o,t){const r={position:"absolute",willChange:this.state.index>=0?this.posMinKey()+","+this.posMaxKey():void 0};return r[this.posMinKey()]=o,r[this.posMaxKey()]=t,r},e.buildMarkStyle=function(o){var t;return(t={position:"absolute"})[this.posMinKey()]=o,t},e.renderThumbs=function(o){const{length:t}=o,r=[];for(let i=0;i<t;i+=1)r[i]=this.buildThumbStyle(o[i],i);const a=[];for(let i=0;i<t;i+=1)a[i]=this.renderThumb(r[i],i);return a},e.renderTracks=function(o){const t=[],r=o.length-1;t.push(this.renderTrack(0,0,o[0]));for(let a=0;a<r;a+=1)t.push(this.renderTrack(a+1,o[a],o[a+1]));return t.push(this.renderTrack(r+1,o[r],this.state.upperBound)),t},e.renderMarks=function(){let{marks:o}=this.props;const t=this.props.max-this.props.min+1;return typeof o=="boolean"?o=Array.from({length:t}).map((r,a)=>a):typeof o=="number"&&(o=Array.from({length:t}).map((r,a)=>a).filter(r=>r%o==0)),o.map(parseFloat).sort((r,a)=>r-a).map(r=>{const a=this.calcOffset(r),i={key:r,className:this.props.markClassName,style:this.buildMarkStyle(a)};return this.props.renderMark(i)})},e.render=function(){const o=[],{value:t}=this.state,r=t.length;for(let h=0;h<r;h+=1)o[h]=this.calcOffset(t[h],h);const a=this.props.withTracks?this.renderTracks(o):null,i=this.renderThumbs(o),c=this.props.marks?this.renderMarks():null;return b.createElement("div",{ref:h=>{this.slider=h,this.resizeElementRef.current=h},style:{position:"relative"},className:this.props.className+(this.props.disabled?" disabled":""),onMouseDown:this.onSliderMouseDown,onClick:this.onSliderClick},a,i,c)},s}(b.Component);te.displayName="ReactSlider",te.defaultProps={min:0,max:100,step:1,pageFn:n=>10*n,minDistance:0,defaultValue:0,orientation:"horizontal",className:"slider",thumbClassName:"thumb",thumbActiveClassName:"active",trackClassName:"track",markClassName:"mark",withTracks:!0,pearling:!1,disabled:!1,snapDragDisabled:!1,invert:!1,marks:[],renderThumb:n=>b.createElement("div",n),renderTrack:n=>b.createElement("div",n),renderMark:n=>b.createElement("span",n)};var pe=te;const Je=n=>new Promise((s,e)=>{const o=new Image;o.addEventListener("load",()=>s(o)),o.addEventListener("error",t=>e(t)),o.setAttribute("crossOrigin","anonymous"),o.src=n});function ye(n){return n*Math.PI/180}function Qe(n,s,e){const o=ye(e);return{width:Math.abs(Math.cos(o)*n)+Math.abs(Math.sin(o)*s),height:Math.abs(Math.sin(o)*n)+Math.abs(Math.cos(o)*s)}}async function et(n,s,e=0,o={horizontal:!1,vertical:!1}){const t=await Je(n),r=document.createElement("canvas"),a=r.getContext("2d");if(!a)return null;const i=ye(e),{width:c,height:h}=Qe(t.width,t.height,e);r.width=c,r.height=h,a.translate(c/2,h/2),a.rotate(i),a.scale(o.horizontal?-1:1,o.vertical?-1:1),a.translate(-t.width/2,-t.height/2),a.drawImage(t,0,0);const u=a.getImageData(s.x,s.y,s.width,s.height);return r.width=s.width,r.height=s.height,a.putImageData(u,0,0),new Promise((p,l)=>{r.toBlob(d=>{d.name="cropped.jpeg",p({file:d,url:URL.createObjectURL(d)})},"image/jpeg")})}const ot=({photoURL:n,openCrop:s,setOpenCrop:e,aspect:o,setPhotoURL:t,setFile:r,maxSizeMB:a})=>{const[i,c]=R.useState({x:0,y:0}),[h,u]=R.useState(1),[p,l]=R.useState(0),[d,m]=R.useState(!1),[g,v]=R.useState(null),[w,T]=R.useState(null),z=R.useCallback((f,S)=>{T(S)},[]),B={maxSizeMB:a||.1,maxWidthOrHeight:800,useWebWorker:!0},K=async()=>{m(!0);try{const{file:f,url:S}=await et(n,w,p),xe=await Ee(f,B);t(S),r(xe),e(!1)}catch(f){v(f),console.log(f)}m(!1)},_=()=>{e(!1)},M=f=>`${Math.round(f*100)}%`;return y.jsx(Me,{isOpen:s,onClose:_,onRequestClose:_,shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,className:"p-0",children:y.jsxs("div",{className:"flex flex-col gap-4 mt-8 w-full max-h-[80vh]",children:[y.jsx(qe,{image:n,crop:i,zoom:h,aspect:o||4/3,rotation:p,onZoomChange:u,onRotationChange:l,onCropChange:c,onCropComplete:z}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("h4",{className:"text-sm",children:["Zoom: ",M(h)]}),y.jsx(pe,{className:"custom_slider",thumbClassName:"custom_slider_thumb bg-primary-500",trackClassName:"custom_slider_track bg-primary-500 custom_slider_track",defaultValue:1,min:1,max:3,step:.01,value:h,onChange:f=>u(f),renderThumb:(f,S)=>y.jsx("div",{...f})})]}),y.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[y.jsxs("h4",{className:"text-sm",children:["Rotation: ",p,"Â°"]}),y.jsx(pe,{className:"custom_slider",thumbClassName:"custom_slider_thumb bg-primary-500",trackClassName:"custom_slider_track bg-primary-500 custom_slider_track",min:0,max:360,value:p,onChange:f=>l(f),renderThumb:(f,S)=>y.jsx("div",{...f})})]}),y.jsxs("div",{className:"w-full flex gap-4 mt-4 justify-center",children:[y.jsx(oe,{size:"sm",icon:y.jsx(Se,{}),onClick:_,children:"Cancel"}),y.jsx(oe,{variant:"solid",size:"sm",type:"button",icon:y.jsx(Re,{}),onClick:K,loading:d,children:"Crop"})]})]})})};export{ot as C};
