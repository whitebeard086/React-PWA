import{u as U,c as k,d as h,r as L,l as q,m as g,H as A,j as e,A as E,F as T,p as $,q as D,t as j,v,I as z,P as B,z as G,D as l,C as H}from"./index-d4dc8e82.js";import{u as O}from"./useTimeOutMessage-b75b21c9.js";import{u as R}from"./useAuth-b6856c85.js";const V=w=>{var x,f;const c=U(),d=k(),{signedIn:m}=h(s=>s.auth.session),{userType:r,verifiedPhone:n,hasService:o}=h(s=>s.auth.user),i=((f=(x=d.state)==null?void 0:x.from)==null?void 0:f.pathname)||"/home";L.useEffect(()=>{let s=i;m&&(r==="Client"&&n?s=i:r==="Client"&&!n?s="/verify":r==="Provider"&&!o?s="/service-setup":r==="Provider"&&!n?s="/verify":r==="Provider"&&o&&n&&(s="/home"),c(s,{replace:!0})),s=""},[i,o,c,m,r,n]),console.log(d);const{disableSubmit:y=!1,className:N,forgotPasswordUrl:b="/forgot-password",signUpUrl:P="/register"}=w,I=q().shape({username:g().required("Please enter your username"),password:g().required("Please enter your password"),rememberMe:A()}),[u,C]=O(),{signIn:F}=R(),S=async(s,a)=>{const{username:t,password:M}=s;a(!0);const p=await F({username:t,password:M});p.status==="failed"&&C(p.message),a(!1)};return e.jsxs("div",{className:N,children:[u&&e.jsx(E,{className:"mb-4",type:"danger",showIcon:!0,children:u}),e.jsx(T,{initialValues:{username:"",password:""},validationSchema:I,onSubmit:(s,{setSubmitting:a})=>{y?a(!1):S(s,a)},children:({touched:s,errors:a,isSubmitting:t})=>e.jsx($,{children:e.jsxs(D,{children:[e.jsx(j,{label:"",invalid:a.username&&s.username,errorMessage:a.username,children:e.jsx(v,{type:"text",autoComplete:"off",name:"username",placeholder:"Username",component:z})}),e.jsx(j,{label:"",invalid:a.password&&s.password,errorMessage:a.password,children:e.jsx(v,{autoComplete:"off",name:"password",placeholder:"Password",component:B})}),e.jsx(G,{block:!0,loading:t,variant:"solid",type:"submit",children:t?"Signing in...":"Sign In"}),e.jsxs("div",{className:"mt-2 text-center text-sm flex flex-col gap-2",children:[e.jsx("div",{children:e.jsx(l,{className:"underline font-bold",to:b,children:"Forgot Password?"})}),e.jsxs("div",{children:[e.jsx("span",{children:"Don't have an account? "}),e.jsx(l,{className:"underline font-bold text-primary-500",to:P,children:"Sign up"}),e.jsxs("span",{children:[" or ",e.jsx(l,{to:"/home",className:"underline font-bold text-primary-500",children:"Continue as Guest"})]})]})]})]})})})]})},W=()=>e.jsx(H,{className:"max-w-xl h-screen bg-white p-4",children:e.jsxs("div",{className:"h-full flex flex-col justify-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("img",{className:"w-80",src:"/img/signin.png",alt:""})}),e.jsx("div",{className:"",children:e.jsx("h1",{className:"font-bold text-lg text-center",children:"Login to continue to Taskitly"})}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{})})]})});export{W as default};
