import{j as e,v as z,O as R,ap as q,S,c2 as L,c as h,z as te,c3 as Q,bo as ge,N as P,a as I,r as f,c4 as de,bA as F,c5 as X,bD as T,bE as J,c6 as pe,$ as H,a0 as M,c7 as we,c8 as ue,c9 as Z,ca as O,cb as K,D as ie,w as ae,y as B,cc as ye,cd as xe,ce as k,cf as Ne,cg as V,ch as ee,ci as Se,cj as G,ck as se,cl as Ce,aN as he,E as _e,cm as be,cn as $e,co as Ee,cp as De,cq as Re}from"./index-402e8dd0.js";import{E as qe}from"./EllipsisButton-6b717551.js";import{s as U,i as ce,u as je}from"./sendPushNotification-8ab9e751.js";import{B as Oe}from"./index-442a2ebd.js";import{A as Te}from"./index-d893efe8.js";import{T as me}from"./index-3698d0f4.js";const Ye=()=>e.jsxs("div",{children:[e.jsx("h4",{children:"Active Bookings"}),e.jsxs("div",{className:"mt-4 mb-4 flex gap-4 overflow-auto pb-4",children:[e.jsxs(z,{className:"min-w-[10rem] w-40",bodyClass:"flex w-full flex-col justify-center items-center",children:[e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center items-center w-full",children:[e.jsx(S,{width:"80%"}),e.jsx(S,{width:"100%"})]})]}),e.jsxs(z,{className:"min-w-[10rem] w-40",bodyClass:"flex w-full flex-col justify-center items-center",children:[e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center items-center w-full",children:[e.jsx(S,{width:"80%"}),e.jsx(S,{width:"100%"})]})]}),e.jsx(z,{className:"min-w-[18rem] w-80",bodyClass:"flex w-full flex-col justify-center items-center",children:e.jsxs("div",{className:"w-full flex items-center gap-4",children:[e.jsxs("div",{className:"w-1/2 flex flex-col items-center",children:[e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center items-center w-full",children:[e.jsx(S,{width:"80%"}),e.jsx(S,{width:"100%"})]})]}),e.jsx(S,{width:"50%",height:"30px"})]})})]}),e.jsx("h4",{children:"Enquiries"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center w-full",children:[e.jsx(S,{width:"40%"}),e.jsx(S,{width:"60%"})]})]}),e.jsx(L,{className:"text-xl"})]})}),e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center w-full",children:[e.jsx(S,{width:"40%"}),e.jsx(S,{width:"60%"})]})]}),e.jsx(L,{className:"text-xl"})]})}),e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center w-full",children:[e.jsx(S,{width:"40%"}),e.jsx(S,{width:"60%"})]})]}),e.jsx(L,{className:"text-xl"})]})}),e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center w-full",children:[e.jsx(S,{width:"40%"}),e.jsx(S,{width:"60%"})]})]}),e.jsx(L,{className:"text-xl"})]})}),e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 justify-center w-full",children:[e.jsx(S,{width:"40%"}),e.jsx(S,{width:"60%"})]})]}),e.jsx(L,{className:"text-xl"})]})})]})]}),fe=()=>{const{imagePath:s}=P,{enquiries:u}=h(c=>c.requests.data),{profile:n}=h(c=>c.auth.user),i=u==null?void 0:u.filter(c=>{var x;return((x=c==null?void 0:c.messages)==null?void 0:x.length)>0});return e.jsx("div",{className:"mt-4 mb-4",children:(i==null?void 0:i.length)<1?e.jsx("div",{className:"min-h-[20vh] flex flex-col justify-center",children:e.jsxs("p",{className:"text-center text-gray-400 font-bold text-2xl",children:["No enquiries, ",e.jsx("br",{})," check back later..."]})}):e.jsx("div",{children:i==null?void 0:i.map(c=>{var d,y,m,t,g,w;const x=(n==null?void 0:n.id)===((d=c==null?void 0:c.receiver)==null?void 0:d.id)?c==null?void 0:c.user:c==null?void 0:c.receiver;return e.jsx(te,{to:`/chat/${x==null?void 0:x.slug}`,state:{chat:c.id},children:e.jsx(z,{className:"rounded-none",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:e.jsx(R,{size:"lg",shape:"circle",src:`${s}/${((y=x.service)==null?void 0:y.banner)||(x==null?void 0:x.image)}`,icon:e.jsx(q,{})})}),e.jsxs("div",{className:"mt-2 flex flex-col justify-center w-full",children:[e.jsx("h4",{className:"text-base",children:((m=x.service)==null?void 0:m.title)||x.username}),e.jsx("p",{className:"text-gray-500 font-semibold",children:e.jsx(Q,{text:(w=(g=c.messages[((t=c.messages)==null?void 0:t.length)-1])==null?void 0:g.message)==null?void 0:w.replace(/<[^>]*>?/gm,""),maxTextCount:60})})]})]}),e.jsx(ge,{customToggleClass:"flex",placement:"top-end",renderTitle:e.jsx(qe,{icon:e.jsx(L,{className:"text-xl text-gray-600"}),variant:"twoTone",shape:"round"})})]})})},c.id)})})})},ze=()=>{var a;const s=I(),{completingService:u,serviceStatus:n,booking:i}=h(l=>l.requests.data),{completeServiceDialog:c,bookingID:x}=h(l=>l.requests.state),{profile:d}=h(l=>l.auth.user),{createStatus:y,notification:m}=h(l=>l.notifications.data),t={receiver_id:i==null?void 0:i.user_id,type:"booking complete",data:JSON.stringify({message:`${(a=d==null?void 0:d.service)==null?void 0:a.title} has completed your service, please inspect the work and confirm if you are satisfied.`,booking_id:i==null?void 0:i.id}),url:"/requests"},g=(l,N,r,E)=>{H.push(e.jsx(M,{title:r||"Error",type:N||"warning",duration:E||3e3,children:l}),{placement:"top-center"})};f.useEffect(()=>{n==="error"&&g("Oops! Something went wrong, please try again.","danger","Error",4e3),s(de("idle"))},[n,s]),f.useEffect(()=>{var l,N,r;n==="success"&&(s(F(t)),U({app_id:"9749386f-0c3b-417c-b986-3447a73296cd",channel_for_external_user_ids:"push",include_external_user_ids:[`${(l=i==null?void 0:i.user)==null?void 0:l.id}`],url:`${P.appURL}/chat/${d==null?void 0:d.username.toLowerCase()}`,contents:{en:`Hello ${(N=i==null?void 0:i.user)==null?void 0:N.username}, ${d==null?void 0:d.username} has completed your service, please inspect the work and confirm if you are satisfied.`},content_available:!0}),g("We have notified the user that booked this service that it has been completed, please wait a moment for them to confirm.","success","Success",8e3)),s(X(!1)),s(de("idle")),T.emit("completedService",(r=i==null?void 0:i.user)==null?void 0:r.id,console.log("Emit Service Completed, Bookings: ",!0))},[n]),f.useEffect(()=>{y==="success"&&(T.emit("sendNotification",[m,i==null?void 0:i.user_id]),s(J("idle")))},[y]);const w=()=>{s(X(!1))},p=()=>{s(we({booking_id:x}))};return e.jsx(pe,{isOpen:c,onClose:w,onRequestClose:w,type:"success",title:"Service Completed?",onCancel:w,onConfirm:p,loading:u,children:e.jsx("p",{children:"Confirm that you have successfully completed this service?"})})},Pe=()=>{var E;const s=I(),[u,n]=f.useState(0),[i,c]=f.useState(!1),[x,d]=f.useState(""),{confirmingService:y,confirmStatus:m,booking:t}=h(j=>j.requests.data),{confirmServiceDialog:g,bookingID:w}=h(j=>j.requests.state),{profile:p}=h(j=>j.auth.user),a=(j,C,D,b)=>{H.push(e.jsx(M,{title:D||"Error",type:C||"warning",duration:b||3e3,children:j}),{placement:"top-center"})};f.useEffect(()=>{u!==0&&i&&c(!1)},[u,i]),f.useEffect(()=>{m==="error"&&a("Oops! Something went wrong, please try again.","danger","Error",4e3),m==="rating error"&&a("Please kindly leave a rating and try again.","danger","Error",4e3),s(ue("idle"))},[m,s]),f.useEffect(()=>{var j,C,D,b,v,_;m==="success"&&(U({app_id:"9749386f-0c3b-417c-b986-3447a73296cd",channel_for_external_user_ids:"push",include_external_user_ids:[`${(C=(j=t==null?void 0:t.service)==null?void 0:j.user)==null?void 0:C.id}`],url:`${P.appURL}/chat/${p==null?void 0:p.username.toLowerCase()}`,contents:{en:`Hello ${(b=(D=t==null?void 0:t.service)==null?void 0:D.user)==null?void 0:b.username}, ${p==null?void 0:p.username} has confirmed the completion of this service, we have released the payment to your Taskitly account.`},content_available:!0}),a("Service completed and closed successfully.","success","Success",8e3)),s(Z(!1)),s(O(null)),T.emit("confirmedService",(_=(v=t==null?void 0:t.service)==null?void 0:v.user)==null?void 0:_.id),s(K()),s(ue("idle"))},[m]);const l=()=>{if(u===0){c(!0);return}s(ye({booking_id:w,rating:u,comment:x}))},N=j=>{var C;d((C=j.target)==null?void 0:C.value)},r=()=>{s(Z(!1)),s(O(null))};return e.jsxs(ie,{isOpen:g,onClose:r,onRequestClose:r,type:"success",title:"Are You Satisfied With This Service?",onCancel:r,onConfirm:l,loading:y,children:[e.jsx("h4",{className:"text-lg font-bold text-gray-700",children:"You are about to release payment"}),e.jsxs("p",{className:"text-base mt-4 text-gray-700",children:["By clicking on ",e.jsx("i",{children:'"Confirm"'}),", it means the service provider has completed their task for you, and you consider the service rendered."]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("h4",{className:"text-lg font-bold text-gray-700 mt-4",children:["Kindly help us rate ",(E=t==null?void 0:t.service)==null?void 0:E.title," and leave a comment."]}),e.jsxs("div",{children:[e.jsx(Te,{style:{maxWidth:250},value:u,onChange:n}),i&&e.jsx(ae.p,{initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.3,type:"tween"},exit:{opacity:0,visibility:"hidden"},className:"text-xs text-red-500 mt-2",children:"Please kindly rate this service"})]}),e.jsx(ce,{className:"w-full block text-sm outline-none p-3 bg-gray-100 overflow-auto resize-none rounded-md border-0 active:border-0",onChange:N,value:x,placeholder:"Your comment on the service provider and the service they rendered.",maxRows:10,minRows:5}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-700 italic",children:"Only Taskitly team can see this comment, it is not published to the general public."}),e.jsx("p",{className:"text-xs text-red-500 italic",children:"This is to help us ensure proper service providers are on the platform."})]}),e.jsxs("div",{className:"flex items-center gap-4 w-full justify-end",children:[e.jsx(B,{className:"!bg-white",onClick:r,children:"Cancel"}),e.jsx(B,{variant:"solid",onClick:l,loading:y,children:"Confirm"})]})]})]})},Ae=()=>{var a;const s=I(),{startingService:u,startStatus:n,booking:i}=h(l=>l.requests.data),{startServiceDialog:c,bookingID:x}=h(l=>l.requests.state),{profile:d}=h(l=>l.auth.user),{createStatus:y,notification:m}=h(l=>l.notifications.data),t={receiver_id:i==null?void 0:i.user_id,type:"booking start",data:JSON.stringify({message:`${(a=d==null?void 0:d.service)==null?void 0:a.title} has resumed your service.`,booking_id:i==null?void 0:i.id}),url:"/requests"},g=(l,N,r,E)=>{H.push(e.jsx(M,{title:r||"Error",type:N||"warning",duration:E||3e3,children:l}),{placement:"top-center"})};f.useEffect(()=>{n==="error"&&g("Oops! Something went wrong, please try again.","danger","Error",4e3),s(xe("idle"))},[n,s]),f.useEffect(()=>{var l,N,r;n==="success"&&(s(F(t)),U({app_id:"9749386f-0c3b-417c-b986-3447a73296cd",channel_for_external_user_ids:"push",include_external_user_ids:[`${(l=i==null?void 0:i.user)==null?void 0:l.id}`],url:`${P.appURL}/chat/${d==null?void 0:d.username.toLowerCase()}`,contents:{en:`Hello ${(N=i==null?void 0:i.user)==null?void 0:N.username}, ${d==null?void 0:d.username} has officially resumed service, we will let you know when he is done.`},content_available:!0}),g("Service resumed.","success","Success",8e3)),s(k(!1)),s(xe("idle")),T.emit("startedService",(r=i==null?void 0:i.user)==null?void 0:r.id,console.log("Emit Service Started, Bookings: ",!0))},[n]),f.useEffect(()=>{y==="success"&&(T.emit("sendNotification",[m,i==null?void 0:i.user_id]),s(J("idle")))},[y]);const w=()=>{s(k(!1))},p=()=>{s(Ne({booking_id:x}))};return e.jsx(pe,{isOpen:c,onClose:w,onRequestClose:w,type:"success",title:"Start Service?",onCancel:w,onConfirm:p,loading:u,children:e.jsx("p",{children:"Officially resume this service?"})})},Be=()=>{var D,b;const s=I(),[u,n]=f.useState(""),[i,c]=f.useState(!1),[x,d]=je(),{cancellingService:y,cancelStatus:m,booking:t}=h(v=>v.requests.data),{cancelServiceDialog:g,bookingID:w}=h(v=>v.requests.state),{profile:p}=h(v=>v.auth.user),{createStatus:a,notification:l}=h(v=>v.notifications.data),N={receiver_id:t==null?void 0:t.user_id,type:"booking cancelled",data:JSON.stringify({message:`${(D=p==null?void 0:p.service)==null?void 0:D.title} has cancelled this service request, your refund will be processed shortly.`,invoice_number:(b=t==null?void 0:t.invoice)==null?void 0:b.invoice_number,booking_id:t==null?void 0:t.id}),url:"/requests"},r=(v,_,o,Y)=>{H.push(e.jsx(M,{title:o||"Error",type:_||"warning",duration:Y||3e3,children:v}),{placement:"top-center"})};f.useEffect(()=>{u.length!==0&&i&&c(!1)},[u,i]),f.useEffect(()=>{m==="error"&&(r("Oops! Something went wrong, please try again.","danger","Error",4e3),s(V("idle"))),m==="reason error"&&(r("Please let us know why you are cancelling this request.","danger","Error",4e3),s(V("idle")))},[m,s]),f.useEffect(()=>{var v,_,o,Y;m==="success"&&(s(F(N)),U({app_id:"9749386f-0c3b-417c-b986-3447a73296cd",channel_for_external_user_ids:"push",include_external_user_ids:[`${(v=t==null?void 0:t.user)==null?void 0:v.id}`],url:`${P.appURL}/requests`,contents:{en:`Hello ${(_=t==null?void 0:t.user)==null?void 0:_.username}, ${p==null?void 0:p.username} has cancelled the service #${(o=t==null?void 0:t.invoice)==null?void 0:o.invoice_number}, your refund will be processed shortly.`},content_available:!0}),r("Service cancelled.","success","Success",8e3)),s(ee(!1)),s(O(null)),T.emit("cancelledService",(Y=t==null?void 0:t.user)==null?void 0:Y.id),s(K()),s(V("idle"))},[m]),f.useEffect(()=>{a==="success"&&(T.emit("sendNotification",[l,t==null?void 0:t.user_id]),s(J("idle")))},[a]);const E=v=>{var _;n((_=v.target)==null?void 0:_.value)},j=()=>{if(u.length<1){c(!0),d();return}s(Se({booking_id:w,reason:u}))},C=()=>{s(ee(!1)),s(O(null))};return e.jsxs(ie,{isOpen:g,onClose:C,onRequestClose:C,type:"info",title:"Are You Sure You Want to Cancel This Service?",onCancel:C,onConfirm:j,loading:y,children:[e.jsx("h4",{className:"text-lg font-bold text-gray-700",children:"You are about to cancel this request"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ce,{className:"w-full block text-sm outline-none p-3 bg-gray-200 overflow-auto resize-none rounded-md border-0 active:border-0",onChange:E,value:u,placeholder:"Kindly tell us why you want to cancel this service request.",maxRows:10,minRows:5,ref:x}),i&&e.jsx(ae.p,{initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.3,type:"tween"},exit:{opacity:0,visibility:"hidden"},className:"text-xs text-red-500 mt-2",children:"Please kindly tell us why you are cancelling this service request"}),e.jsxs("div",{className:"flex items-center gap-4 w-full justify-end mt-4",children:[e.jsx(B,{className:"!bg-white",onClick:C,children:"Cancel"}),e.jsx(B,{variant:"solid",color:"red-500",onClick:j,loading:y,children:"Confirm"})]})]})]})},Le=()=>{var v,_,o,Y,ne,le,re,oe;const s=I(),[u,n]=f.useState(""),[i,c]=f.useState(!1),[x,d]=je(),{openingDispute:y,disputeStatus:m,booking:t,dispute:g}=h($=>$.requests.data),{openDisputeDialog:w,bookingID:p}=h($=>$.requests.state),{profile:a}=h($=>$.auth.user),{createStatus:l,notification:N}=h($=>$.notifications.data);let r;((v=t==null?void 0:t.user)==null?void 0:v.id)===(a==null?void 0:a.id)?r=(_=t==null?void 0:t.service)==null?void 0:_.user:((Y=(o=t==null?void 0:t.service)==null?void 0:o.user)==null?void 0:Y.id)===(a==null?void 0:a.id)&&(r=t==null?void 0:t.user);const E={receiver_id:r==null?void 0:r.id,type:"booking disputed",data:JSON.stringify({message:`${(ne=a==null?void 0:a.service)!=null&&ne.title?(le=a==null?void 0:a.service)==null?void 0:le.title:`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`} has opened dispute on the service request #${(re=t==null?void 0:t.invoice)==null?void 0:re.invoice_number}, you have 24hrs to respond.`,invoice_number:(oe=t==null?void 0:t.invoice)==null?void 0:oe.invoice_number,booking_id:t==null?void 0:t.id}),url:`/requests/disputes/${g==null?void 0:g.uid}`},j=($,A,W,ve)=>{H.push(e.jsx(M,{title:W||"Error",type:A||"warning",duration:ve||3e3,children:$}),{placement:"top-center"})};f.useEffect(()=>{u.length!==0&&i&&c(!1)},[u,i]),f.useEffect(()=>{m==="error"&&(j("Oops! Something went wrong, please try again.","danger","Error",4e3),s(G("idle"))),m==="reason error"&&(j("Please let us know why you want to lodge a complaint.","danger","Error",4e3),s(G("idle")))},[s,m]),f.useEffect(()=>{var $,A,W;m==="success"&&(s(F(E)),U({app_id:"9749386f-0c3b-417c-b986-3447a73296cd",channel_for_external_user_ids:"push",include_external_user_ids:[`${r==null?void 0:r.id}`],url:`${P.appURL}/requests/disputes/${g==null?void 0:g.id}`,contents:{en:`${($=a==null?void 0:a.service)!=null&&$.title?(A=a==null?void 0:a.service)==null?void 0:A.title:`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`} has opened dispute on the service request #${(W=t==null?void 0:t.invoice)==null?void 0:W.invoice_number}, you have 24hrs to respond.`},content_available:!0}),j("Service in dispute.","success","Success",8e3)),s(se(!1)),s(O(null)),T.emit("openedDispute",r==null?void 0:r.id),s(K()),s(G("idle"))},[m]),f.useEffect(()=>{l==="success"&&(T.emit("sendNotification",[N,r==null?void 0:r.id]),s(J("idle")))},[l]);const C=$=>{var A;n((A=$.target)==null?void 0:A.value)},D=()=>{if(u.length<1){c(!0),d();return}s(Ce({booking_id:p,reason:u}))},b=()=>{s(se(!1)),s(O(null))};return e.jsxs(ie,{isOpen:w,onClose:b,onRequestClose:b,type:"info",title:"Are You Sure You Want to Report This Service Request?",onCancel:b,onConfirm:D,loading:y,children:[e.jsx("h4",{className:"text-lg font-bold text-gray-700",children:"You are about to report this service request"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ce,{className:"w-full block text-sm outline-none p-3 bg-gray-200 overflow-auto resize-none rounded-md border-0 active:border-0",onChange:C,value:u,placeholder:"Kindly tell us what you are dissatisfied about.",maxRows:10,minRows:5,ref:x}),i&&e.jsx(ae.p,{initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.3,type:"tween"},exit:{opacity:0,visibility:"hidden"},className:"text-xs text-red-500 mt-2",children:"Please kindly tell us what you are dissatisfied about"}),e.jsxs("div",{className:"flex items-center gap-4 w-full justify-end mt-4",children:[e.jsx(B,{className:"!bg-white",onClick:b,children:"Cancel"}),e.jsx(B,{variant:"solid",color:"red-500",onClick:D,loading:y,children:"Confirm"})]})]})]})},Ie=()=>{const{disputes:s}=h(n=>n.requests.data),{userType:u}=h(n=>n.auth.user);return e.jsx("div",{className:"mt-4 mb-4",children:s==null?void 0:s.map(n=>{var i,c,x,d;return e.jsx(te,{to:`disputes/${n.uid}`,children:e.jsx(z,{className:"rounded-none",children:e.jsx("div",{className:"w-full flex items-center justify-between",children:e.jsxs("div",{className:"w-full flex gap-4 items-center",children:[e.jsx("div",{children:u==="Client"?e.jsx(R,{size:"lg",shape:"circle",src:`${(i=P)==null?void 0:i.imagePath}/${n.booking.service.banner}`,icon:e.jsx(q,{})}):e.jsx(R,{size:"lg",shape:"circle",src:`${(c=P)==null?void 0:c.imagePath}/${n.booking.user.image}`,icon:e.jsx(q,{})})}),e.jsx("div",{className:"flex items-center gap-4 justify-between w-full",children:e.jsxs("div",{className:"mt-2 flex flex-col justify-center w-full",children:[e.jsx("h4",{className:"text-base",children:u==="Client"?n.booking.service.title:`${n.booking.user.first_name} ${n.booking.user.last_name}`}),e.jsx("p",{className:"text-gray-500 font-semibold",children:((x=n.messages)==null?void 0:x.length)>0?e.jsx(Q,{text:n.messages[n.messages.length-1].message,maxTextCount:60}):e.jsx(Q,{text:n.description,maxTextCount:60})}),e.jsx("p",{className:"text-xs heading-text font-bold",children:((d=n.messages)==null?void 0:d.length)>0?he(n.messages[n.messages.length-1].created_at).format("DD MMM, YYYY - h:mm A"):he(n.created_at).format("DD MMM, YYYY - h:mm A")})]})})]})})})},n.id)})})};_e("requests",Re);const Ke=()=>{const s=I(),{imagePath:u}=P,{bookings:n,booking:i,disputes:c,completingService:x,confirmingService:d}=h(o=>o.requests.data),{bookingID:y}=h(o=>o.requests.state),{userType:m}=h(o=>o.auth.user),t=m==="Provider",{loading:g,serviceCompleted:w,serviceConfirmed:p,serviceStarted:a,serviceCancelled:l}=h(o=>{var Y;return(Y=o.requests)==null?void 0:Y.data}),{TabNav:N,TabList:r,TabContent:E}=me;window.OneSignal=window.OneSignal||[];const j=window.OneSignal;j.push(()=>{j.init({appId:"9749386f-0c3b-417c-b986-3447a73296cd",safari_web_id:"web.onesignal.auto.4d0b3421-6847-4c4b-a531-b4bcf634e4d8",allowLocalhostAsSecureOrigin:!0,autoResubscribe:!0})}),f.useEffect(()=>{(w||p||a||l)&&s(K()),w?s(be(!1)):p?s($e(!1)):a?s(Ee(!1)):l&&s(De(!1))},[s,l,w,p,a]);const C=o=>{s(se(!0)),s(O(o==null?void 0:o.id))},D=o=>{s(k(!0)),s(O(o==null?void 0:o.id))},b=o=>{s(ee(!0)),s(O(o==null?void 0:o.id))},v=o=>{s(X(!0)),s(O(o==null?void 0:o.id))},_=o=>{s(Z(!0)),s(O(o==null?void 0:o.id))};return e.jsxs("div",{className:"mt-2 p-4",children:[g?e.jsx(Ye,{}):e.jsxs("div",{children:[e.jsx("h4",{children:"Active Bookings"}),e.jsx("div",{className:"mt-4 mb-4",children:e.jsx(Oe,{imagePath:u,bookings:n,booking:i,completingService:x,confirmingService:d,bookingID:y,isProvider:t,onComplete:v,onConfirm:_,onStart:D,onCancel:b,onReport:C})}),(c==null?void 0:c.length)>0&&e.jsx("div",{className:"mt-10",children:e.jsxs(me,{defaultValue:"enquiries",variant:"pill",children:[e.jsxs(r,{className:"justify-start gap-4 text-base",children:[e.jsx(N,{value:"enquiries",children:"Enquiries"}),e.jsx(N,{value:"disputes",children:"Disputes"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(E,{value:"enquiries",children:e.jsx("div",{className:"min-h-[50vh]",children:e.jsx(fe,{})})}),e.jsx(E,{value:"disputes",children:e.jsx("div",{className:"min-h-[50vh]",children:e.jsx(Ie,{})})})]})]})}),(c==null?void 0:c.length)<1&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Enquiries"}),e.jsx("div",{className:"min-h-[50vh]",children:e.jsx(fe,{})})]})]}),e.jsx("div",{className:"sticky bottom-24 flex justify-end mr-5",children:e.jsx(te,{to:"history",children:e.jsx(B,{variant:"solid",children:"Booking History"})})}),e.jsx(ze,{socket:T.current}),e.jsx(Pe,{socket:T.current}),e.jsx(Ae,{}),e.jsx(Be,{}),e.jsx(Le,{})]})};export{Ke as default};
