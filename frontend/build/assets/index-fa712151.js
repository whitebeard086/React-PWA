import{aF as K,aG as B,aH as H,h as A,d9 as T,aK as X,i as z,c as J,k as Q,l as _,r as m,aL as y,da as U,j as e,L as k,db as W,F as Y,o as Z,p as ee,q as N,t as D,d5 as g,d6 as E,X as se,y as te,E as ae,dc as re}from"./index-cd793fee.js";import{d as ne}from"./debounce-0d96812f.js";import"./bundle-248220b4.js";const d="disco",ce=K(),I=B(T,`${d}/data/verifyCustomer`),C=ce.getInitialState({customer:{...H},store:{}}),V=A({name:`${d}/data`,initialState:C,reducers:{setStore:(s,t)=>{s.store=t.payload===0?{}:t.payload},resetState:(s,t)=>{const a={user:()=>{s.user=C.user}}[t.payload];a&&a()}},extraReducers:s=>{X(s,I,"customer","customer")}}),{setStore:le,resetState:ye}=V.actions,oe=V.reducer,ie={state:{state:!1,steps:0},kycDialog:!1,pinDialog:!1,query:{search:""}},$=A({name:`${d}/state`,initialState:ie,reducers:{setState:(s,{payload:t})=>{s.state.state=t!==0,s.state.steps=t===0?0:t},setSearch:(s,{payload:t})=>{s.query.search=t},toggleKycDialog:(s,{payload:t})=>{s.kycDialog=t},togglePinDialog:(s,{payload:t})=>{s.pinDialog=t}}}),{setState:P,setSearch:Se,toggleKycDialog:fe,togglePinDialog:Fe}=$.actions,de=$.reducer,ue=z({state:de,data:oe}),v=J,me=Q().shape({meter_type:_().required("Please select meter type"),device_number:_().required("Please enter meter number")}),b={meter_type:"",device_number:""},xe=()=>{var f;m.useState(b);const[s,t]=m.useState(b),n=y(),{store:a,customer:u}=v(r=>r[d].data),o=r=>{n(I(r))},x=m.useRef(ne(o,1e3)).current;m.useEffect(()=>()=>{x.cancel()},[]),m.useEffect(()=>{if(s.meter_type&&s.device_number&&s.device_number.length>10){const r={...a,...s};console.log("payload: ",r),R(r)}},[s]);const{isFetching:S,data:j}=U(a),{products:c}=j||{};v(r=>r.auth.user),console.log("Products: ",c),console.log("customer: ",u);const M=[{value:"prepaid",name:"prepaid"},{value:"postpaid",name:"postpaid"}],R=r=>{x(r)},q=r=>{};return e.jsxs(k,{loading:S,children:[e.jsxs("div",{className:"inline-flex items-center cursor-pointer py-2 pr-2 mb-2",onClick:()=>{n(P(0))},children:[e.jsx(W,{})," Back"]}),c!=null&&c.success&&((f=c==null?void 0:c.data)==null?void 0:f.length)>0?e.jsx(Y,{initialValues:b,validationSchema:me,onSubmit:r=>q(),children:({touched:r,errors:p,values:F})=>e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsxs("div",{className:"flex flex-col xx:flex-row xx:gap-2",children:[e.jsx(N,{label:"Meter type",invalid:p.meter_type&&r.meter_type,errorMessage:p.meter_type,children:e.jsx(D,{name:"meter_type",children:({field:i,form:h})=>e.jsx(g,{className:"flex flex-col gap-2 xx:flex-row",value:[i.value],onChange:l=>{h.setFieldValue(i.name,l[0]),t({...s,[i.name]:l[0]})},children:e.jsx(e.Fragment,{children:M.map((l,ge)=>e.jsx(g.Item,{value:l.value,children:({ref:L,active:w,onSegmentItemClick:O,disabled:G})=>e.jsx(E,{ref:L,active:w,disabled:G,className:"bg-slate-50",onSegmentItemClick:O,variant:"plain",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-base",children:l.value})})})},l.value))})})})}),e.jsx(N,{label:"Meter number",invalid:p.device_number&&r.device_number,errorMessage:p.device_number,className:"xx:flex-1 xx:justify-between",children:e.jsx(D,{name:"device_number",children:({field:i,form:h})=>e.jsx(se,{className:"xx:h-12",form:h,field:i,placeholder:"Meter number",format:"###",onValueChange:l=>{h.setFieldValue(i.name,l.value),t({...s,[i.name]:l.value})}})})})]}),e.jsx(te,{variant:"solid",type:"submit",block:!0,className:"!bg-gray-900 hover:!bg-black",disabled:!F.bundle||!F.phone,children:"Continue"})]})})}):e.jsx("p",{className:"mb-4",children:"Sorry this distro is currently unavailable."})]})},pe=({operators:s})=>{var n;const t=y();return e.jsx(g,{className:"grid grid-cols-pow gap-3",onChange:a=>{t(le({operatorID:a[0],bill:"electricity"})),t(P(1))},children:(n=s==null?void 0:s.data)==null?void 0:n.map((a,u)=>e.jsx(g.Item,{value:a.id,children:({ref:o,active:x,value:S,onSegmentItemClick:j,disabled:c})=>e.jsx(E,{ref:o,active:x,disabled:c,className:"bg-slate-50",onSegmentItemClick:j,variant:"plain",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx("p",{className:"text-xs",children:a==null?void 0:a.desc}),e.jsx("h6",{children:a==null?void 0:a.name})]})})},a.id))})};ae(`${d}`,ue);const he=()=>{y();const{data:s,isFetching:t}=re("electricity"),{operators:n}=s||{},{state:a}=v(o=>o[d].state),{store:u}=v(o=>o[d].data);return console.log("Operators: ",n),console.log("State: ",a),console.log("Store: ",u),e.jsx("div",{className:"p-4 mt-2",children:e.jsx(k,{loading:t,children:a.state?e.jsx(e.Fragment,{children:a.steps===1&&e.jsx(xe,{data:u})}):e.jsx(e.Fragment,{children:e.jsx(pe,{operators:n})})})})},_e=he;export{_e as default};
