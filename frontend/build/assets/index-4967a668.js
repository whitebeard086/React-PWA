import{h as C,d as _,c_ as Z,c$ as z,i as O,a as w,r as d,c as j,U as T,j as t,w as U,y as $,Y as R,Z as A,E as V}from"./index-cd793fee.js";import{P as b}from"./bundle-248220b4.js";const L=C({name:"pin/state",initialState:{},reducers:{}}),B=L.reducer,N=_("profile/data/createPin",async(a,{rejectWithValue:e})=>{try{return(await Z(a)).data}catch(n){return e(n.response.data)}}),P=_("profile/data/updatePin",async(a,{rejectWithValue:e})=>{try{return(await z(a)).data}catch(n){return e(n.response.data)}}),Y=C({name:"pin/data",initialState:{loading:!1,status:"idle",message:""},reducers:{setStatus:(a,e)=>{a.status=e.payload}},extraReducers:a=>{a.addCase(N.pending,e=>{e.loading=!0}).addCase(N.fulfilled,(e,n)=>{e.loading=!1;const{status:i}=n.payload;e.status=i}).addCase(N.rejected,(e,n)=>{e.loading=!1;const{status:i,message:c}=n.payload;e.status=i,e.message=c}).addCase(P.pending,e=>{e.loading=!0}).addCase(P.fulfilled,(e,n)=>{e.loading=!1;const{status:i}=n.payload;e.status=i}).addCase(P.rejected,(e,n)=>{e.loading=!1;const{status:i,message:c}=n.payload;e.status=i,e.message=c})}}),{setStatus:h}=Y.actions,q=Y.reducer,G=O({state:B,data:q}),E={padding:void 0,margin:void 0,textAlign:void 0,border:void 0,background:void 0,width:void 0,height:void 0},I={outline:void 0,boxShadow:void 0},H=()=>{const a=w(),[e,n]=d.useState(""),[i,c]=d.useState(""),{loading:o,status:u}=j(r=>r.pin.data);let g=!1,l=!1;i.length===6&&i!==e&&(g=!0),i.length===6&&i===e&&(l=!0);const p=(r,y,x,m)=>{R.push(t.jsx(A,{title:x||"Error",type:y||"warning",duration:m||3e3,children:r}),{placement:"top-center"})};d.useEffect(()=>{u==="error"&&(p("Oops! Something went wrong, please try again.","danger","Error",5e3),a(h("idle"))),u==="success"&&(a(T()),p("Transaction PIN created successfully.","success","Success",5e3),a(h("idle")))},[a,u]);const f=()=>{a(N({pin:e,pin_confirmation:i}))};return t.jsx("div",{children:t.jsxs("form",{onSubmit:async r=>{r.preventDefault(),f()},children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-base mb-2",children:"Enter PIN"}),t.jsx(b,{length:6,initialValue:"",secretDelay:200,onChange:r=>{n(r)},type:"numeric",inputMode:"number",inputStyle:E,inputFocusStyle:I,autoSelect:!0,regexCriteria:/^[ A-Za-z0-9_@./#&+-]*$/})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-base mb-2",children:"Enter PIN Again"}),t.jsx(b,{length:6,initialValue:"",secretDelay:200,disabled:e.length<6,onChange:r=>{c(r)},type:"numeric",inputMode:"number",inputStyle:E,inputFocusStyle:I,autoSelect:!0,regexCriteria:/^[ A-Za-z0-9_@./#&+-]*$/}),g&&t.jsx(U.p,{className:"text-red-500 mt-2",layoutId:1,initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.4,type:"tween"},exit:{opacity:0,visibility:"hidden"},children:"Your PIN do not match!"},1)]}),t.jsx($,{block:!0,type:"submit",variant:"solid",className:"!bg-gray-900 hover:!bg-black mt-2",loading:o,disabled:!e||!i||e.length<6||i.length<6||g||!l,children:"Create"})]})})},S={padding:void 0,margin:void 0,textAlign:void 0,border:void 0,background:void 0,width:void 0,height:void 0},v={outline:void 0,boxShadow:void 0},J=()=>{const a=w(),[e,n]=d.useState(""),[i,c]=d.useState(""),[o,u]=d.useState(""),{loading:g,status:l}=j(s=>s.pin.data);let p=!1,f=!1,r,y,x;o.length===6&&o!==i&&(p=!0),o.length===6&&o===i&&(f=!0);const m=(s,k,F,M)=>{R.push(t.jsx(A,{title:F||"Error",type:k||"warning",duration:M||3e3,children:s}),{placement:"top-center"})};d.useEffect(()=>{const s=()=>{x.clear(),y.clear(),r.clear(),n(""),c(""),u("")};l==="error"&&(m("Oops! Something went wrong, please try again.","danger","Error",5e3),s(),a(h("idle"))),l==="pin error"&&(m("The PIN entered does not match your transaction PIN, please try again.","danger","Error",5e3),s(),a(h("idle"))),l==="duplicate error"&&(m("The PIN entered is the same as your transaction PIN, please enter a new PIN.","danger","Error",5e3),s(),a(h("idle"))),l==="success"&&(a(T()),m("Transaction PIN updated successfully.","success","Success",5e3),s(),a(h("idle")))},[x,a,y,r,l]);const D=()=>{a(P({old_pin:e,pin:i,pin_confirmation:o}))};return t.jsx("div",{children:t.jsxs("form",{onSubmit:async s=>{s.preventDefault(),D()},children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-base mb-2",children:"Enter Old PIN"}),t.jsx(b,{length:6,initialValue:"",secretDelay:200,ref:s=>r=s,onChange:s=>{n(s)},type:"numeric",inputMode:"number",inputStyle:S,inputFocusStyle:v,autoSelect:!0,regexCriteria:/^[ A-Za-z0-9_@./#&+-]*$/})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-base mb-2",children:"Enter New PIN"}),t.jsx(b,{length:6,initialValue:"",secretDelay:200,ref:s=>y=s,disabled:e.length<6,onChange:s=>{c(s)},type:"numeric",inputMode:"number",inputStyle:S,inputFocusStyle:v,autoSelect:!0,regexCriteria:/^[ A-Za-z0-9_@./#&+-]*$/})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-base mb-2",children:"Enter New PIN Again"}),t.jsx(b,{length:6,initialValue:"",secretDelay:200,ref:s=>x=s,disabled:i.length<6,onChange:s=>{u(s)},type:"numeric",inputMode:"number",inputStyle:S,inputFocusStyle:v,autoSelect:!0,regexCriteria:/^[ A-Za-z0-9_@./#&+-]*$/}),p&&t.jsx(U.p,{className:"text-red-500 mt-2",layoutId:1,initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.4,type:"tween"},exit:{opacity:0,visibility:"hidden"},children:"Your PIN do not match!"},1)]}),t.jsx($,{block:!0,type:"submit",variant:"solid",className:"!bg-gray-900 hover:!bg-black mt-2",loading:g,disabled:!e||!i||!o||e.length<6||i.length<6||o.length<6||p||!f,children:"Update"})]})})};V("pin",G);const W=()=>{const{hasPin:a}=j(e=>e.auth.user);return t.jsx("div",{className:"mt-2 p-4",children:a?t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-bold text-gray-700 mb-4",children:"Update Your Transaction PIN"}),t.jsx("div",{className:"mt-4",children:t.jsx(J,{})})]}):t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-bold text-gray-700 mb-4",children:"Create Your Transaction PIN"}),t.jsx("div",{className:"mt-4",children:t.jsx(H,{})})]})})};export{W as default};
