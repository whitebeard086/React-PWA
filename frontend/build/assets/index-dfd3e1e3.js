import{j as e,v as p,S as i,bG as f,a as N,c as w,bh as U,w as X,cR as $,cS as k,k as Z,l as D,r as b,cT as L,cU as R,W as B,cV as V,cW as H,cX as O,cY as J,F as K,o as Q,p as ee,q as _,t as F,X as se,cZ as P,Z as ae,c_ as te,c$ as re,n as ne,P as le,y as I,d0 as ie,$ as q,a0 as z,d1 as ce,d2 as oe,d3 as W,D as de,d4 as ue,c6 as he,d5 as xe,E as me,d6 as ge,d7 as pe}from"./index-2cc994c4.js";const fe=()=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})}),e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})}),e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})}),e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})}),e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})}),e.jsx(p,{bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(i,{height:"20px",width:"30%"}),e.jsx(i,{height:"14px",width:"25%"}),e.jsx(i,{height:"14px",width:"35%"})]}),e.jsx("div",{className:"bg-gray-100 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})})]}),we=()=>{const s=N(),{profile:r}=w(c=>c.auth.user),d=r==null?void 0:r.withdrawal_accounts,t=c=>{s($(c.id)),s(k(!0)),console.log(c)};return e.jsx("div",{children:(d==null?void 0:d.length)<1?e.jsx("div",{className:"min-h-[30vh] grid place-content-center",children:e.jsxs("p",{className:"text-center text-gray-400 font-bold text-2xl",children:["You have not added ",e.jsx("br",{})," any withdrawal accounts..."]})}):e.jsx(U,{children:e.jsx("div",{className:"flex flex-col",children:d==null?void 0:d.map(c=>e.jsx(X.div,{layoutId:c.id,initial:{opacity:0,visibility:"hidden"},animate:{opacity:1,visibility:"visible"},transition:{duration:.2,type:"tween"},exit:{opacity:0,visibility:"hidden"},children:e.jsx(p,{clickable:!0,className:"z-10",bodyClass:"w-full",children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("h4",{className:"text-base",children:c.bank_name}),e.jsx("p",{className:"text-base",children:c.account_number}),e.jsx("p",{className:"text-base",children:c.account_name})]}),e.jsx("div",{onClick:()=>t(c),className:"bg-gray-100 z-20 hover:bg-gray-200 transition duration-300 w-10 h-10 grid place-content-center rounded-full cursor-pointer hover:shadow-md",children:e.jsx(f,{className:"text-2xl text-red-500 hover:text-red-600 transition duration-300"})})]})})},c.id))})})})},je=()=>{const s=N(),{banks:r,resolvingAccount:d,resolvedAccount:t,resolveStatus:c,resolveError:x,accountStatus:u,recipientStatus:m,recipient:n,creatingRecipient:S,addingAccount:A}=w(a=>a.withdraw.data),{isValidAccountNumber:g,formData:E}=w(a=>a.withdraw.state),M=Z().shape({bank:D().required("Please select a bank"),accNumber:D().required("Please enter your account number"),password:D().required("Please enter your password")}),T={bank:"",accNumber:"",password:""},v=r==null?void 0:r.map(a=>({label:a.name,value:a.code})),y=(a,l,o,h)=>{q.push(e.jsx(z,{title:o||"Error",type:l||"warning",duration:h||3e3,children:a}),{placement:"top-center"})};b.useEffect(()=>{x!==""&&s(L("idle"))},[x,c]),b.useEffect(()=>{(u==="error"||m==="error")&&y("Oops! Something went wrong, please try again.","danger","Error",5e3),u==="password error"&&y("The password entered does not match your account password, please try again.","danger","Error",5e3),u==="duplicate error"&&y("Account already added or in use by another user","danger","Error",5e3),u==="success"&&(s(R(!1)),s(B()),s(V()),y("Withdrawal account added successfully.","success","Success",5e3)),(u==="error"||u==="password error"||u==="duplicate error"||u==="success")&&(s(H("idle")),s(O("idle"))),m==="error"&&s(O("idle"))},[u,s,m]),b.useEffect(()=>{var a,l,o;m==="success"&&s(J({bankName:(a=n==null?void 0:n.details)==null?void 0:a.bank_name,accountNumber:(l=n==null?void 0:n.details)==null?void 0:l.account_number,accountName:(o=n==null?void 0:n.details)==null?void 0:o.account_name,recipientCode:n==null?void 0:n.recipient_code,password:E==null?void 0:E.password}))},[m]);const Y=a=>{const{bank:l,accNumber:o,password:h}=a;s(ce({bankCode:l,accountNumber:o,password:h})),s(oe({accountName:t==null?void 0:t.account_name,accountNumber:o,bankCode:l}))},G=(a,l,o,h)=>{o.setFieldValue(h.name,a.floatValue),a.value.length>=10?g||s(W(!0)):g&&s(W(!1)),a.value.length===10&&l.bank&&s(P({accountNumber:a.floatValue,bankCode:l.bank}))};return e.jsx("div",{className:"mt-10",children:e.jsx(K,{initialValues:T,validationSchema:M,onSubmit:(a,{setSubmitting:l})=>{Y(a)},children:({touched:a,errors:l,values:o})=>e.jsx(Q,{children:e.jsxs(ee,{children:[e.jsx(_,{label:"",invalid:l.bank&&a.bank,className:"w-full",errorMessage:l.bank,children:e.jsx(F,{name:"bank",prefix:"",className:"w-full",autoComplete:"off",children:({field:h,form:j})=>e.jsx(se,{placeholder:"Select a Bank",field:h,form:j,className:"w-full",options:v,value:v==null?void 0:v.value,onChange:C=>{j.setFieldValue(h.name,C.value),o.accNumber>=10&&s(P({accountNumber:o.accNumber,bankCode:C.value}))}})})}),e.jsx(_,{label:"",invalid:l.accNumber&&a.accNumber,errorMessage:l.accNumber,children:e.jsx(F,{name:"accNumber",children:({field:h,form:j})=>e.jsx(ae,{thousandSeparator:!1,form:j,field:h,maxLength:10,placeholder:"Enter Account Number",decimalScale:0,value:h.value,onValueChange:C=>{G(C,o,j,h)}})})}),o.bank&&g&&d?e.jsx("div",{className:"p-2 mb-4 grid place-content-center",children:e.jsx(te,{indicator:re,color:"primary-500",size:24})}):o.bank&&g&&(t!=null&&t.account_name||x)?e.jsx("div",{className:ne("p-2 border-2 mb-4 rounded-lg",x&&"border-red-500",c==="success"&&"border-primary-500"),children:e.jsxs("p",{className:"text-sm font-semibold text-gray-500",children:[x&&"Invalid account details",c==="success"&&(t==null?void 0:t.account_name)]})}):null,e.jsx(_,{label:"",invalid:l.password&&a.password,errorMessage:l.password,children:e.jsx(F,{autoComplete:"off",name:"password",placeholder:"Enter Your Password",component:le})}),e.jsx(I,{block:!0,loading:S||A,disabled:!g||!(t!=null&&t.account_name)||!o.password,variant:"solid",type:"submit",icon:e.jsx(ie,{}),className:"!bg-gray-900 hover:!bg-black",children:"Save"})]})})})})},be=()=>{const s=N(),{accountDialog:r}=w(t=>t.withdraw.state),d=()=>{s(R(!1))};return e.jsxs(de,{isOpen:r,onClose:d,shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,scrollable:!0,className:"overflow-y-auto",bodyOpenClassName:"overflow-hidden",contentClassName:"mt-[20vh]",title:"Add New Account",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-700",children:"Add a New Bank Account"}),e.jsx("div",{className:"mt-4 min-h-[40vh]",children:e.jsx(je,{})})]})},Ne=()=>{const s=N(),{deleteStatus:r,deleting:d}=w(n=>n.withdraw.data),{deleteDialog:t,selectedAccount:c}=w(n=>n.withdraw.state),x=()=>{s($(null)),s(k(!1))},u=(n,S,A,g)=>{q.push(e.jsx(z,{title:A||"Error",type:S||"warning",duration:g||3e3,children:n}),{placement:"top-center"})};b.useEffect(()=>{r==="error"&&(s(k(!1)),u("Oops! Something went wrong, please try again.","danger","Error",5e3)),r==="success"&&(s(k(!1)),s(B()),s(V()),u("Withdrawal account removed successfully","success","Success",5e3)),(r==="error"||r==="success")&&s(ue("idle"))},[r,s]);const m=()=>{s(xe({id:c}))};return e.jsx(he,{isOpen:t,onClose:x,onRequestClose:x,type:"danger",title:"Remove Withdrawal Account?",buttonColor:"red-500",loading:d,onCancel:x,onConfirm:m,children:e.jsx("p",{children:"Do you confirm that you want to remove this withdrawal account?"})})};me("withdraw",pe);const ye=()=>{const s=N(),{loading:r}=w(t=>t.withdraw.data);b.useEffect(()=>{s(V())},[]);const d=()=>{s(R(!0))};return e.jsxs("div",{className:"mt-2 p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 justify-between flex-wrap",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-700",children:"Withdrawal Banks"}),e.jsx(I,{size:"sm",variant:"solid",disabled:r,icon:e.jsx(ge,{}),onClick:d,className:"!bg-gray-900 hover:!bg-black",children:"Add Account"})]}),e.jsx("div",{className:"mt-4",children:r?e.jsx(fe,{}):e.jsx(we,{})}),e.jsx(be,{}),e.jsx(Ne,{})]})};export{ye as default};
