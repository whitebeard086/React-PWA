import{u as U,b as k,c as p,r as L,o as A,p as h,M as E,j as e,A as T,F as $,v as q,w as B,x as g,y as j,I as D,P as G,G as H,H as v,C as O}from"./index-2aa62b4f.js";import{u as R}from"./useTimeOutMessage-8d4d5856.js";import{u as V}from"./useAuth-9ed3d467.js";const z=w=>{var u,x;const l=U(),c=k(),{signedIn:d}=p(s=>s.auth.session),{userType:r,verifiedPhone:n,hasService:o}=p(s=>s.auth.user),i=((x=(u=c.state)==null?void 0:u.from)==null?void 0:x.pathname)||"/home";L.useEffect(()=>{let s=i;d&&(r==="Client"&&n?s=i:r==="Client"&&!n?s="/verify":r==="Provider"&&!o?s="/service-setup":r==="Provider"&&!n?s="/verify":r==="Provider"&&o&&n&&(s="/home"),l(s,{replace:!0})),s=""},[i,o,l,d,r,n]),console.log(c);const{disableSubmit:y=!1,className:N,forgotPasswordUrl:b="/forgot-password",signUpUrl:P="/register"}=w,I=A().shape({username:h().required("Please enter your username"),password:h().required("Please enter your password"),rememberMe:E()}),[m,F]=R(),{signIn:C}=V(),S=async(s,a)=>{const{username:t,password:M}=s;a(!0);const f=await C({username:t,password:M});f.status==="failed"&&F(f.message),a(!1)};return e.jsxs("div",{className:N,children:[m&&e.jsx(T,{className:"mb-4",type:"danger",showIcon:!0,children:m}),e.jsx($,{initialValues:{username:"",password:""},validationSchema:I,onSubmit:(s,{setSubmitting:a})=>{y?a(!1):S(s,a)},children:({touched:s,errors:a,isSubmitting:t})=>e.jsx(q,{children:e.jsxs(B,{children:[e.jsx(g,{label:"",invalid:a.username&&s.username,errorMessage:a.username,children:e.jsx(j,{type:"text",autoComplete:"off",name:"username",placeholder:"Username",component:D})}),e.jsx(g,{label:"",invalid:a.password&&s.password,errorMessage:a.password,children:e.jsx(j,{autoComplete:"off",name:"password",placeholder:"Password",component:G})}),e.jsx(H,{block:!0,loading:t,variant:"solid",type:"submit",children:t?"Signing in...":"Sign In"}),e.jsxs("div",{className:"mt-2 text-center text-sm flex flex-col gap-2",children:[e.jsx("div",{children:e.jsx(v,{className:"underline font-bold",to:b,children:"Forgot Password?"})}),e.jsxs("div",{children:[e.jsx("span",{children:"Don't have an account? "}),e.jsx(v,{className:"underline font-bold text-primary-500",to:P,children:"Sign up"})]})]})]})})})]})},W=()=>e.jsx(O,{className:"max-w-xl h-screen bg-white p-4",children:e.jsxs("div",{className:"h-full flex flex-col justify-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("img",{className:"w-80",src:"/img/signin.png",alt:""})}),e.jsx("div",{className:"",children:e.jsx("h1",{className:"font-bold text-lg text-center",children:"Login to continue to Taskitly"})}),e.jsx("div",{className:"mt-4",children:e.jsx(z,{})})]})});export{W as default};
