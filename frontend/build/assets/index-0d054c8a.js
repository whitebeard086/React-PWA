import{u as U,m as k,n as x,r as L,j as e,A,F as E,p as h,I as T,w as $,x as g,C as q}from"./index-508e130b.js";import{F as B,a as D,b as j}from"./formik.esm-5d2ef744.js";import{c as O,a as v,d as R}from"./index.esm-5685692b.js";import{u as V}from"./useTimeOutMessage-bfa14556.js";import{P as z}from"./PasswordInput-29c811c0.js";import{u as G}from"./useAuth-1f924dc5.js";const H=w=>{var u,f;const l=U(),c=k(),{signedIn:d}=x(s=>s.auth.session),{userType:r,verifiedPhone:n,hasService:o}=x(s=>s.auth.user),i=((f=(u=c.state)==null?void 0:u.from)==null?void 0:f.pathname)||"/home";L.useEffect(()=>{let s=i;d&&(r==="Client"&&n?s=i:r==="Client"&&!n?s="/verify":r==="Provider"&&!o?s="/service-setup":r==="Provider"&&!n?s="/verify":r==="Provider"&&o&&n&&(s="/home"),l(s,{replace:!0})),s=""},[i,o,l,d,r,n]),console.log(c);const{disableSubmit:y=!1,className:N,forgotPasswordUrl:b="/forgot-password",signUpUrl:P="/register"}=w,I=O().shape({username:v().required("Please enter your username"),password:v().required("Please enter your password"),rememberMe:R()}),[m,F]=V(),{signIn:C}=G(),S=async(s,a)=>{const{username:t,password:M}=s;a(!0);const p=await C({username:t,password:M});p.status==="failed"&&F(p.message),a(!1)};return e.jsxs("div",{className:N,children:[m&&e.jsx(A,{className:"mb-4",type:"danger",showIcon:!0,children:m}),e.jsx(B,{initialValues:{username:"",password:""},validationSchema:I,onSubmit:(s,{setSubmitting:a})=>{y?a(!1):S(s,a)},children:({touched:s,errors:a,isSubmitting:t})=>e.jsx(D,{children:e.jsxs(E,{children:[e.jsx(h,{label:"",invalid:a.username&&s.username,errorMessage:a.username,children:e.jsx(j,{type:"text",autoComplete:"off",name:"username",placeholder:"Username",component:T})}),e.jsx(h,{label:"",invalid:a.password&&s.password,errorMessage:a.password,children:e.jsx(j,{autoComplete:"off",name:"password",placeholder:"Password",component:z})}),e.jsx($,{block:!0,loading:t,variant:"solid",type:"submit",children:t?"Signing in...":"Sign In"}),e.jsxs("div",{className:"mt-2 text-center text-sm flex flex-col gap-2",children:[e.jsx("div",{children:e.jsx(g,{className:"underline font-bold",to:b,children:"Forgot Password?"})}),e.jsxs("div",{children:[e.jsx("span",{children:"Don't have an account? "}),e.jsx(g,{className:"underline font-bold text-primary-500",to:P,children:"Sign up"})]})]})]})})})]})},Z=()=>e.jsx(q,{className:"max-w-xl h-screen bg-white p-4",children:e.jsxs("div",{className:"h-full flex flex-col justify-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("img",{className:"w-80",src:"/img/signin.png",alt:""})}),e.jsx("div",{className:"",children:e.jsx("h1",{className:"font-bold text-lg text-center",children:"Login to continue to Taskitly"})}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{})})]})});export{Z as default};
